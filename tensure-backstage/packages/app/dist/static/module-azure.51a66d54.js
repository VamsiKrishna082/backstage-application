"use strict";(()=>{(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2288],{10181:(Yo,Jo,k)=>{function gn(...t){if(t.length>0){const e=String(t[0]);e.includes(":error")?console.error(...t):e.includes(":warning")?console.warn(...t):e.includes(":info")?console.info(...t):e.includes(":verbose")?console.debug(...t):console.debug(...t)}}var ve=k(39907);const Xe=typeof ve<"u"&&ve.env&&ve.env.DEBUG||void 0;let Ye,Ae=[],Ce=[];const F=[];Xe&&Te(Xe);const Je=Object.assign(t=>Ge(t),{enable:Te,enabled:Se,disable:yn,log:gn});function Te(t){Ye=t,Ae=[],Ce=[];const e=/\*/g,n=t.split(",").map(r=>r.trim().replace(e,".*?"));for(const r of n)r.startsWith("-")?Ce.push(new RegExp(`^${r.substr(1)}$`)):Ae.push(new RegExp(`^${r}$`));for(const r of F)r.enabled=Se(r.namespace)}function Se(t){if(t.endsWith("*"))return!0;for(const e of Ce)if(e.test(t))return!1;for(const e of Ae)if(e.test(t))return!0;return!1}function yn(){const t=Ye||"";return Te(""),t}function Ge(t){const e=Object.assign(n,{enabled:Se(t),destroy:pn,log:Je.log,namespace:t,extend:wn});function n(...r){e.enabled&&(r.length>0&&(r[0]=`${t} ${r[0]}`),e.log(...r))}return F.push(e),e}function pn(){const t=F.indexOf(this);return t>=0?(F.splice(t,1),!0):!1}function wn(t){const e=Ge(`${this.namespace}:${t}`);return e.log=this.log,e}const U=Je;var Ee=k(39907);const Qe=new Set,W=typeof Ee<"u"&&Ee.env&&Ee.env.AZURE_LOG_LEVEL||void 0;let j;const Re=U("azure");Re.log=(...t)=>{U.log(...t)};const Pe=["verbose","info","warning","error"];W&&(nt(W)?bn(W):console.error(`AZURE_LOG_LEVEL set to unknown log level '${W}'; logging is not enabled. Acceptable values: ${Pe.join(", ")}.`));function bn(t){if(t&&!nt(t))throw new Error(`Unknown log level '${t}'. Acceptable values: ${Pe.join(",")}`);j=t;const e=[];for(const n of Qe)tt(n)&&e.push(n.namespace);U.enable(e.join(","))}function Go(){return j}const Ze={verbose:400,info:300,warning:200,error:100};function K(t){const e=Re.extend(t);return et(Re,e),{error:X(e,"error"),warning:X(e,"warning"),info:X(e,"info"),verbose:X(e,"verbose")}}function et(t,e){e.log=(...n)=>{t.log(...n)}}function X(t,e){const n=Object.assign(t.extend(e),{level:e});if(et(t,n),tt(n)){const r=U.disable();U.enable(r+","+n.namespace)}return Qe.add(n),n}function tt(t){return!!(j&&Ze[t.level]<=Ze[j])}function nt(t){return Pe.includes(t)}var vn=k(39907);const P=K("identity");function An(t){return t.reduce((e,n)=>(vn.env[n]?e.assigned.push(n):e.missing.push(n),e),{missing:[],assigned:[]})}function Qo(t,e){const{assigned:n}=An(e);P.info(`${t} => Found the following environment variables: ${n.join(", ")}`)}function Cn(t){return`SUCCESS. Scopes: ${Array.isArray(t)?t.join(", "):t}.`}function Y(t,e){let n="ERROR.";return t?.length&&(n+=` Scopes: ${Array.isArray(t)?t.join(", "):t}.`),`${n} Error message: ${typeof e=="string"?e:e.message}.`}function rt(t,e,n=P){const r=e?`${e.fullTitle} ${t}`:t;function i(c){n.info(`${r} =>`,c)}function o(c){n.warning(`${r} =>`,c)}function a(c){n.verbose(`${r} =>`,c)}function s(c){n.error(`${r} =>`,c)}return{title:t,fullTitle:r,info:i,warning:o,verbose:a,error:s}}function E(t,e=P){const n=rt(t,void 0,e);return Object.assign(Object.assign({},n),{parent:e,getToken:rt("=> getToken()",n,e)})}function Tn(t){return t&&typeof t.error=="string"&&typeof t.error_description=="string"}const Sn="CredentialUnavailableError";class En extends Error{constructor(e,n){super(e,n),this.name=Sn}}const it="AuthenticationError";class Rn extends Error{constructor(e,n,r){let i={error:"unknown",errorDescription:"An unknown error occurred and no additional details are available."};if(Tn(n))i=ot(n);else if(typeof n=="string")try{const o=JSON.parse(n);i=ot(o)}catch{e===400?i={error:"invalid_request",errorDescription:`The service indicated that the request was invalid.

${n}`}:i={error:"unknown_error",errorDescription:`An unknown error has occurred. Response body:

${n}`}}else i={error:"unknown_error",errorDescription:"An unknown error occurred and no additional details are available."};super(`${i.error} Status code: ${e}
More details:
${i.errorDescription},`,r),this.statusCode=e,this.errorResponse=i,this.name=it}}const Pn="AggregateAuthenticationError";class _n extends Error{constructor(e,n){const r=e.join(`
`);super(`${n}
${r}`),this.errors=e,this.name=Pn}}function ot(t){return{error:t.error,errorDescription:t.error_description,correlationId:t.correlation_id,errorCodes:t.error_codes,timestamp:t.timestamp,traceId:t.trace_id}}class Zo extends Error{constructor(e){super(e.message,e.cause?{cause:e.cause}:void 0),this.scopes=e.scopes,this.getTokenOptions=e.getTokenOptions,this.name="AuthenticationRequiredError"}}const at="4.9.1",ea="04b07795-8ddb-461a-bbee-02f9e1bf7b46",ta="common";var _e;(function(t){t.AzureChina="https://login.chinacloudapi.cn",t.AzureGermany="https://login.microsoftonline.de",t.AzureGovernment="https://login.microsoftonline.us",t.AzurePublicCloud="https://login.microsoftonline.com"})(_e||(_e={}));const xn=_e.AzurePublicCloud,na="login.microsoftonline.com",ra=null,ia="cae",oa="nocae",aa="msal.cache",L={span:Symbol.for("@azure/core-tracing span"),namespace:Symbol.for("@azure/core-tracing namespace")};function In(t={}){let e=new B(t.parentContext);return t.span&&(e=e.setValue(L.span,t.span)),t.namespace&&(e=e.setValue(L.namespace,t.namespace)),e}class B{constructor(e){this._contextMap=e instanceof B?new Map(e._contextMap):new Map}setValue(e,n){const r=new B(this);return r._contextMap.set(e,n),r}getValue(e){return this._contextMap.get(e)}deleteValue(e){const n=new B(this);return n._contextMap.delete(e),n}}const xe={instrumenterImplementation:void 0};function $n(){return{end:()=>{},isRecording:()=>!1,recordException:()=>{},setAttribute:()=>{},setStatus:()=>{},addEvent:()=>{}}}function On(){return{createRequestHeaders:()=>({}),parseTraceparentHeader:()=>{},startSpan:(t,e)=>({span:$n(),tracingContext:In({parentContext:e.tracingContext})}),withContext(t,e,...n){return e(...n)}}}function sa(t){state.instrumenterImplementation=t}function J(){return xe.instrumenterImplementation||(xe.instrumenterImplementation=On()),xe.instrumenterImplementation}function st(t){const{namespace:e,packageName:n,packageVersion:r}=t;function i(l,u,d){var f;const m=J().startSpan(l,Object.assign(Object.assign({},d),{packageName:n,packageVersion:r,tracingContext:(f=u?.tracingOptions)===null||f===void 0?void 0:f.tracingContext}));let h=m.tracingContext;const g=m.span;h.getValue(L.namespace)||(h=h.setValue(L.namespace,e)),g.setAttribute("az.namespace",h.getValue(L.namespace));const p=Object.assign({},u,{tracingOptions:Object.assign(Object.assign({},u?.tracingOptions),{tracingContext:h})});return{span:g,updatedOptions:p}}async function o(l,u,d,f){const{span:m,updatedOptions:h}=i(l,u,f);try{const g=await a(h.tracingOptions.tracingContext,()=>Promise.resolve(d(h,m)));return m.setStatus({status:"success"}),g}catch(g){throw m.setStatus({status:"error",error:g}),g}finally{m.end()}}function a(l,u,...d){return J().withContext(l,u,...d)}function s(l){return J().parseTraceparentHeader(l)}function c(l){return J().createRequestHeaders(l)}return{startSpan:i,withSpan:o,withContext:a,parseTraceparentHeader:s,createRequestHeaders:c}}const lt=st({namespace:"Microsoft.AAD",packageName:"@azure/identity",packageVersion:at}),Ie=E("ChainedTokenCredential");class kn{constructor(...e){this._sources=[],this._sources=e}async getToken(e,n={}){const{token:r}=await this.getTokenInternal(e,n);return r}async getTokenInternal(e,n={}){let r=null,i;const o=[];return lt.withSpan("ChainedTokenCredential.getToken",n,async a=>{for(let s=0;s<this._sources.length&&r===null;s++)try{r=await this._sources[s].getToken(e,a),i=this._sources[s]}catch(c){if(c.name==="CredentialUnavailableError"||c.name==="AuthenticationRequiredError")o.push(c);else throw Ie.getToken.info(Y(e,c)),c}if(!r&&o.length>0){const s=new _n(o,"ChainedTokenCredential authentication failed.");throw Ie.getToken.info(Y(e,s)),s}if(Ie.getToken.info(`Result for ${i.constructor.name}: ${Cn(e)}`),r===null)throw new En("Failed to retrieve a valid token");return{token:r,successfulCredential:i}})}}const G=new Error("DefaultAzureCredential is not supported in the browser. Use InteractiveBrowserCredential instead."),ct=E("DefaultAzureCredential");class la extends kn{constructor(e){throw super(),ct.info(Y("",G)),G}getToken(){throw ct.getToken.info(Y("",G)),G}}class $e extends Error{constructor(e){super(e),this.name="AbortError"}}function ca(t,e){const{cleanupBeforeAbort:n,abortSignal:r,abortErrorMsg:i}=e??{};return new Promise((o,a)=>{function s(){a(new AbortError(i??"The operation was aborted."))}function c(){r?.removeEventListener("abort",l)}function l(){n?.(),c(),s()}if(r?.aborted)return s();try{t(u=>{c(),o(u)},u=>{c(),a(u)})}catch(u){a(u)}r?.addEventListener("abort",l)})}function Nn(t,e){return t=Math.ceil(t),e=Math.floor(e),Math.floor(Math.random()*(e-t+1))+t}const Dn="The delay was aborted.";function ua(t,e){let n;const{abortSignal:r,abortErrorMsg:i}=e??{};return createAbortablePromise(o=>{n=setTimeout(o,t)},{cleanupBeforeAbort:()=>clearTimeout(n),abortSignal:r,abortErrorMsg:i??Dn})}function Mn(t,e){const n=e.retryDelayInMs*Math.pow(2,t),r=Math.min(e.maxRetryDelayInMs,n);return{retryAfterInMs:r/2+Nn(0,r/2)}}function ut(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)&&!(t instanceof RegExp)&&!(t instanceof Date)}function Oe(t){if(ut(t)){const e=typeof t.name=="string",n=typeof t.message=="string";return e&&n}return!1}function Q(t){if(Oe(t))return t.message;{let e;try{typeof t=="object"&&t?e=JSON.stringify(t):e=String(t)}catch{e="[unable to stringify input]"}return`Unknown error ${e}`}}function da(t,e){switch(e){case"utf-8":return Un(t);case"base64":return dt(t);case"base64url":return zn(t);case"hex":return Ln(t)}}function $(t,e){switch(e){case"utf-8":return Bn(t);case"base64":return ft(t);case"base64url":return Hn(t);case"hex":return qn(t)}}function dt(t){return btoa([...t].map(e=>String.fromCharCode(e)).join(""))}function zn(t){return dt(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function Un(t){return new TextDecoder().decode(t)}function Ln(t){return[...t].map(e=>e.toString(16).padStart(2,"0")).join("")}function Bn(t){return new TextEncoder().encode(t)}function ft(t){return new Uint8Array([...atob(t)].map(e=>e.charCodeAt(0)))}function Hn(t){const e=t.replace(/-/g,"+").replace(/_/g,"/");return ft(e)}const ht=new Set("0123456789abcdefABCDEF");function qn(t){const e=new Uint8Array(t.length/2);for(let n=0;n<t.length/2;++n){const r=t[2*n],i=t[2*n+1];if(!ht.has(r)||!ht.has(i))return e.slice(0,n);e[n]=parseInt(`${r}${i}`,16)}return e}let Z;function mt(){if(Z)return Z;if(!self.crypto||!self.crypto.subtle)throw new Error("Your browser environment does not support cryptography functions.");return Z=self.crypto.subtle,Z}async function fa(t,e,n){const r=mt(),i=stringToUint8Array(t,"base64"),o=stringToUint8Array(e,"utf-8"),a=await r.importKey("raw",i,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),s=await r.sign({name:"HMAC",hash:{name:"SHA-256"}},a,o);return uint8ArrayToString(new Uint8Array(s),n)}async function ha(t,e){const n=stringToUint8Array(t,"utf-8"),r=await mt().digest({name:"SHA-256"},n);return uint8ArrayToString(new Uint8Array(r),e)}function gt(){let t="";for(let e=0;e<32;e++){const n=Math.floor(Math.random()*16);e===12?t+="4":e===16?t+=n&3|8:t+=n.toString(16),(e===7||e===11||e===15||e===19)&&(t+="-")}return t}function ma(){return gt()}var ke;const Vn=typeof((ke=globalThis?.crypto)===null||ke===void 0?void 0:ke.randomUUID)=="function"?globalThis.crypto.randomUUID.bind(globalThis.crypto):gt;function yt(){return Vn()}var Ne,De,Me,ze;const ga=typeof window<"u"&&typeof window.document<"u",ya=typeof self=="object"&&typeof self?.importScripts=="function"&&(((Ne=self.constructor)===null||Ne===void 0?void 0:Ne.name)==="DedicatedWorkerGlobalScope"||((De=self.constructor)===null||De===void 0?void 0:De.name)==="ServiceWorkerGlobalScope"||((Me=self.constructor)===null||Me===void 0?void 0:Me.name)==="SharedWorkerGlobalScope"),Fn=typeof Deno<"u"&&typeof Deno.version<"u"&&typeof Deno.version.deno<"u",Wn=typeof Bun<"u"&&typeof Bun.version<"u",H=typeof globalThis.process<"u"&&!!globalThis.process.version&&!!(!((ze=globalThis.process.versions)===null||ze===void 0)&&ze.node),jn=H,pa=H&&!Wn&&!Fn,wa=typeof navigator<"u"&&navigator?.product==="ReactNative";var Kn=k(39907);const q=E("IdentityUtils"),pt="1.0";function ba(t,e,n){const r=i=>(q.getToken.info(i),new AuthenticationRequiredError({scopes:Array.isArray(t)?t:[t],getTokenOptions:n,message:i}));if(!e)throw r("No response");if(!e.expiresOn)throw r('Response had no "expiresOn" property.');if(!e.accessToken)throw r('Response had no "accessToken" property.')}function va(t){let e=t?.authorityHost;return!e&&isNodeLike&&(e=Kn.env.AZURE_AUTHORITY_HOST),e??DefaultAuthorityHost}function Aa(t,e){return e||(e=DefaultAuthorityHost),new RegExp(`${t}/?$`).test(e)?e:e.endsWith("/")?e+t:`${e}/${t}`}function Ca(t,e,n){return t==="adfs"&&e||n?[e]:[]}const Ta=(t,e=isNode?"Node":"Browser")=>(n,r,i)=>{if(!i)switch(n){case msalCommon.LogLevel.Error:t.info(`MSAL ${e} V2 error: ${r}`);return;case msalCommon.LogLevel.Info:t.info(`MSAL ${e} V2 info message: ${r}`);return;case msalCommon.LogLevel.Verbose:t.info(`MSAL ${e} V2 verbose message: ${r}`);return;case msalCommon.LogLevel.Warning:t.info(`MSAL ${e} V2 warning: ${r}`);return}};function Sa(t){switch(t){case"error":return msalCommon.LogLevel.Error;case"info":return msalCommon.LogLevel.Info;case"verbose":return msalCommon.LogLevel.Verbose;case"warning":return msalCommon.LogLevel.Warning;default:return msalCommon.LogLevel.Info}}function Ea(){return coreRandomUUID()}function Ra(t,e,n){if(e.name==="AuthError"||e.name==="ClientAuthError"||e.name==="BrowserAuthError"){const r=e;switch(r.errorCode){case"endpoints_resolution_error":return q.info(formatError(t,e.message)),new CredentialUnavailableError(e.message);case"device_code_polling_cancelled":return new AbortError("The authentication has been aborted by the caller.");case"consent_required":case"interaction_required":case"login_required":q.info(formatError(t,`Authentication returned errorCode ${r.errorCode}`));break;default:q.info(formatError(t,`Failed to acquire token: ${e.message}`));break}}return e.name==="ClientConfigurationError"||e.name==="BrowserConfigurationAuthError"||e.name==="AbortError"||e.name==="AuthenticationError"?e:e.name==="NativeAuthError"?(q.info(formatError(t,`Error from the native broker: ${e.message} with status code: ${e.statusCode}`)),e):new AuthenticationRequiredError({scopes:t,getTokenOptions:n,message:e.message})}function Pa(t){return{localAccountId:t.homeAccountId,environment:t.authority,username:t.username,homeAccountId:t.homeAccountId,tenantId:t.tenantId}}function _a(t,e){var n;return{authority:(n=e.environment)!==null&&n!==void 0?n:DefaultAuthority,homeAccountId:e.homeAccountId,tenantId:e.tenantId||DefaultTenantId,username:e.username,clientId:t,version:pt}}function xa(t){return JSON.stringify(t)}function Ia(t){const e=JSON.parse(t);if(e.version&&e.version!==pt)throw Error("Unsupported AuthenticationRecord version");return e}const wt=new Set(["Deserialize","Serialize","Retry","Sign"]);class ee{constructor(e){var n;this._policies=[],this._policies=(n=e?.slice(0))!==null&&n!==void 0?n:[],this._orderedPolicies=void 0}addPolicy(e,n={}){if(n.phase&&n.afterPhase)throw new Error("Policies inside a phase cannot specify afterPhase.");if(n.phase&&!wt.has(n.phase))throw new Error(`Invalid phase name: ${n.phase}`);if(n.afterPhase&&!wt.has(n.afterPhase))throw new Error(`Invalid afterPhase name: ${n.afterPhase}`);this._policies.push({policy:e,options:n}),this._orderedPolicies=void 0}removePolicy(e){const n=[];return this._policies=this._policies.filter(r=>e.name&&r.policy.name===e.name||e.phase&&r.options.phase===e.phase?(n.push(r.policy),!1):!0),this._orderedPolicies=void 0,n}sendRequest(e,n){return this.getOrderedPolicies().reduceRight((o,a)=>s=>a.sendRequest(s,o),o=>e.sendRequest(o))(n)}getOrderedPolicies(){return this._orderedPolicies||(this._orderedPolicies=this.orderPolicies()),this._orderedPolicies}clone(){return new ee(this._policies)}static create(){return new ee}orderPolicies(){const e=[],n=new Map;function r(h){return{name:h,policies:new Set,hasRun:!1,hasAfterPolicies:!1}}const i=r("Serialize"),o=r("None"),a=r("Deserialize"),s=r("Retry"),c=r("Sign"),l=[i,o,a,s,c];function u(h){return h==="Retry"?s:h==="Serialize"?i:h==="Deserialize"?a:h==="Sign"?c:o}for(const h of this._policies){const g=h.policy,p=h.options,v=g.name;if(n.has(v))throw new Error("Duplicate policy names not allowed in pipeline");const A={policy:g,dependsOn:new Set,dependants:new Set};p.afterPhase&&(A.afterPhase=u(p.afterPhase),A.afterPhase.hasAfterPolicies=!0),n.set(v,A),u(p.phase).policies.add(A)}for(const h of this._policies){const{policy:g,options:p}=h,v=g.name,A=n.get(v);if(!A)throw new Error(`Missing node for policy ${v}`);if(p.afterPolicies)for(const R of p.afterPolicies){const b=n.get(R);b&&(A.dependsOn.add(b),b.dependants.add(A))}if(p.beforePolicies)for(const R of p.beforePolicies){const b=n.get(R);b&&(b.dependsOn.add(A),A.dependants.add(b))}}function d(h){h.hasRun=!0;for(const g of h.policies)if(!(g.afterPhase&&(!g.afterPhase.hasRun||g.afterPhase.policies.size))&&g.dependsOn.size===0){e.push(g.policy);for(const p of g.dependants)p.dependsOn.delete(g);n.delete(g.policy.name),h.policies.delete(g)}}function f(){for(const h of l){if(d(h),h.policies.size>0&&h!==o){o.hasRun||d(o);return}h.hasAfterPolicies&&d(o)}}let m=0;for(;n.size>0;){m++;const h=e.length;if(f(),e.length<=h&&m>1)throw new Error("Cannot satisfy policy dependencies due to requirements cycle.")}return e}}function Xn(){return ee.create()}const N=K("core-rest-pipeline"),Ue="REDACTED",Yn=["x-ms-client-request-id","x-ms-return-client-request-id","x-ms-useragent","x-ms-correlation-request-id","x-ms-request-id","client-request-id","ms-cv","return-client-request-id","traceparent","Access-Control-Allow-Credentials","Access-Control-Allow-Headers","Access-Control-Allow-Methods","Access-Control-Allow-Origin","Access-Control-Expose-Headers","Access-Control-Max-Age","Access-Control-Request-Headers","Access-Control-Request-Method","Origin","Accept","Accept-Encoding","Cache-Control","Connection","Content-Length","Content-Type","Date","ETag","Expires","If-Match","If-Modified-Since","If-None-Match","If-Unmodified-Since","Last-Modified","Pragma","Request-Id","Retry-After","Server","Transfer-Encoding","User-Agent","WWW-Authenticate"],Jn=["api-version"];class Le{constructor({additionalAllowedHeaderNames:e=[],additionalAllowedQueryParameters:n=[]}={}){e=Yn.concat(e),n=Jn.concat(n),this.allowedHeaderNames=new Set(e.map(r=>r.toLowerCase())),this.allowedQueryParameters=new Set(n.map(r=>r.toLowerCase()))}sanitize(e){const n=new Set;return JSON.stringify(e,(r,i)=>{if(i instanceof Error)return Object.assign(Object.assign({},i),{name:i.name,message:i.message});if(r==="headers")return this.sanitizeHeaders(i);if(r==="url")return this.sanitizeUrl(i);if(r==="query")return this.sanitizeQuery(i);if(r==="body")return;if(r==="response")return;if(r==="operationSpec")return;if(Array.isArray(i)||ut(i)){if(n.has(i))return"[Circular]";n.add(i)}return i},2)}sanitizeUrl(e){if(typeof e!="string"||e===null||e==="")return e;const n=new URL(e);if(!n.search)return e;for(const[r]of n.searchParams)this.allowedQueryParameters.has(r.toLowerCase())||n.searchParams.set(r,Ue);return n.toString()}sanitizeHeaders(e){const n={};for(const r of Object.keys(e))this.allowedHeaderNames.has(r.toLowerCase())?n[r]=e[r]:n[r]=Ue;return n}sanitizeQuery(e){if(typeof e!="object"||e===null)return e;const n={};for(const r of Object.keys(e))this.allowedQueryParameters.has(r.toLowerCase())?n[r]=e[r]:n[r]=Ue;return n}}const Gn="logPolicy";function Qn(t={}){var e;const n=(e=t.logger)!==null&&e!==void 0?e:N.info,r=new Le({additionalAllowedHeaderNames:t.additionalAllowedHeaderNames,additionalAllowedQueryParameters:t.additionalAllowedQueryParameters});return{name:Gn,async sendRequest(i,o){if(!n.enabled)return o(i);n(`Request: ${r.sanitize(i)}`);const a=await o(i);return n(`Response status code: ${a.status}`),n(`Headers: ${r.sanitize(a.headers)}`),a}}}const Zn="redirectPolicy",bt=["GET","HEAD"];function er(t={}){const{maxRetries:e=20}=t;return{name:Zn,async sendRequest(n,r){const i=await r(n);return vt(r,i,e)}}}async function vt(t,e,n,r=0){const{request:i,status:o,headers:a}=e,s=a.get("location");if(s&&(o===300||o===301&&bt.includes(i.method)||o===302&&bt.includes(i.method)||o===303&&i.method==="POST"||o===307)&&r<n){const c=new URL(s,i.url);i.url=c.toString(),o===303&&(i.method="GET",i.headers.delete("Content-Length"),delete i.body),i.headers.delete("Authorization");const l=await t(i);return vt(t,l,n,r+1)}return e}function tr(){return"x-ms-useragent"}function nr(t){const e=[{name:"Firefox",regex:/Firefox\/([\d.]+)/},{name:"Safari",regex:/Version\/([\d.]+).*Safari/}];for(const n of e){const r=t.match(n.regex);if(r)return{brand:n.name,version:r[1]}}}function rr(t){const e=["Google Chrome","Microsoft Edge","Opera","Brave","Chromium"];for(const n of e){const r=t.find(i=>i.brand===n);if(r)return r}}async function ir(t){const e=globalThis.navigator;let n="unknown";if(e?.userAgentData){const r=await e.userAgentData.getHighEntropyValues(["architecture","platformVersion"]);n=`${r.architecture}-${r.platform}-${r.platformVersion}`;const i=rr(e.userAgentData.brands);i&&t.set(i.brand,i.version)}else if(e?.platform){n=e.platform;const r=nr(e.userAgent);r&&t.set(r.brand,r.version)}else typeof globalThis.EdgeRuntime=="string"&&t.set("EdgeRuntime",globalThis.EdgeRuntime);t.set("OS",n)}const At="1.19.1",Be=3;function or(t){const e=[];for(const[n,r]of t){const i=r?`${n}/${r}`:n;e.push(i)}return e.join(" ")}function ar(){return tr()}async function Ct(t){const e=new Map;e.set("core-rest-pipeline",At),await ir(e);const n=or(e);return t?`${t} ${n}`:n}const Tt=ar(),sr="userAgentPolicy";function lr(t={}){const e=Ct(t.userAgentPrefix);return{name:sr,async sendRequest(n,r){return n.headers.has(Tt)||n.headers.set(Tt,await e),r(n)}}}const St={arrayBuffer:()=>{throw new Error("Not implemented")},bytes:()=>{throw new Error("Not implemented")},slice:()=>{throw new Error("Not implemented")},text:()=>{throw new Error("Not implemented")}},te=Symbol("rawContent");function cr(t){return typeof t[te]=="function"}function ur(t){return cr(t)?t[te]():t.stream()}function $a(t,e,n={}){var r,i,o,a;return Object.assign(Object.assign({},St),{type:(r=n.type)!==null&&r!==void 0?r:"",lastModified:(i=n.lastModified)!==null&&i!==void 0?i:new Date().getTime(),webkitRelativePath:(o=n.webkitRelativePath)!==null&&o!==void 0?o:"",size:(a=n.size)!==null&&a!==void 0?a:-1,name:e,stream:()=>{const s=t();if(isNodeReadableStream(s))throw new Error("Not supported: a Node stream was provided as input to createFileFromStream.");return s},[te]:t})}function Oa(t,e,n={}){var r,i,o;return isNodeLike?Object.assign(Object.assign({},St),{type:(r=n.type)!==null&&r!==void 0?r:"",lastModified:(i=n.lastModified)!==null&&i!==void 0?i:new Date().getTime(),webkitRelativePath:(o=n.webkitRelativePath)!==null&&o!==void 0?o:"",size:t.byteLength,name:e,arrayBuffer:async()=>t.buffer,stream:()=>new Blob([t]).stream(),[te]:()=>t}):new File([t],e,n)}function He(t){return!!(t&&typeof t.pipe=="function")}function ne(t){return!!(t&&typeof t.getReader=="function"&&typeof t.tee=="function")}function ka(t){return He(t)||ne(t)}function dr(t){return typeof t.stream=="function"}function fr(t){return new Response(t).blob()}async function Et(t){if(t instanceof Blob||t instanceof Uint8Array)return t;if(ne(t))return fr(t);const e=ur(t);if(He(e))throw new Error("Encountered unexpected type. In the browser, `concat` supports Web ReadableStream, Blob, Uint8Array, and files created using `createFile` only.");return Et(e)}async function hr(t){const e=[];for(const n of t)e.push(await Et(typeof n=="function"?n():n));return new Blob(e)}function mr(){return`----AzSDKFormBoundary${yt()}`}function gr(t){let e="";for(const[n,r]of t)e+=`${n}: ${r}\r
`;return e}function yr(t){return t instanceof Uint8Array?t.byteLength:dr(t)?t.size===-1?void 0:t.size:void 0}function pr(t){let e=0;for(const n of t){const r=yr(n);if(r===void 0)return;e+=r}return e}async function wr(t,e,n){const r=[$(`--${n}`,"utf-8"),...e.flatMap(o=>[$(`\r
`,"utf-8"),$(gr(o.headers),"utf-8"),$(`\r
`,"utf-8"),o.body,$(`\r
--${n}`,"utf-8")]),$(`--\r
\r
`,"utf-8")],i=pr(r);i&&t.headers.set("Content-Length",i),t.body=await hr(r)}const Rt="multipartPolicy",br=70,vr=new Set("abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'()+,-./:=?");function Ar(t){if(t.length>br)throw new Error(`Multipart boundary "${t}" exceeds maximum length of 70 characters`);if(Array.from(t).some(e=>!vr.has(e)))throw new Error(`Multipart boundary "${t}" contains invalid characters`)}function Cr(){return{name:Rt,async sendRequest(t,e){var n;if(!t.multipartBody)return e(t);if(t.body)throw new Error("multipartBody and regular body cannot be set at the same time");let r=t.multipartBody.boundary;const i=(n=t.headers.get("Content-Type"))!==null&&n!==void 0?n:"multipart/mixed",o=i.match(/^(multipart\/[^ ;]+)(?:; *boundary=(.+))?$/);if(!o)throw new Error(`Got multipart request body, but content-type header was not multipart: ${i}`);const[,a,s]=o;if(s&&r&&s!==r)throw new Error(`Multipart boundary was specified as ${s} in the header, but got ${r} in the request body`);return r??(r=s),r?Ar(r):r=mr(),t.headers.set("Content-Type",`${a}; boundary=${r}`),await wr(t,t.multipartBody.parts,r),t.multipartBody=void 0,e(t)}}}const Na="decompressResponsePolicy";function Tr(){throw new Error("decompressResponsePolicy is not supported in browser environment")}const Sr="The operation was aborted.";function Pt(t,e,n){return new Promise((r,i)=>{let o,a;const s=()=>i(new $e(n?.abortErrorMsg?n?.abortErrorMsg:Sr)),c=()=>{n?.abortSignal&&a&&n.abortSignal.removeEventListener("abort",a)};if(a=()=>(o&&clearTimeout(o),c(),s()),n?.abortSignal&&n.abortSignal.aborted)return s();o=setTimeout(()=>{c(),r(e)},t),n?.abortSignal&&n.abortSignal.addEventListener("abort",a)})}function Er(t,e){const n=t.headers.get(e);if(!n)return;const r=Number(n);if(!Number.isNaN(r))return r}const qe="Retry-After",Rr=["retry-after-ms","x-ms-retry-after-ms",qe];function _t(t){if(t&&[429,503].includes(t.status))try{for(const i of Rr){const o=Er(t,i);if(o===0||o)return o*(i===qe?1e3:1)}const e=t.headers.get(qe);if(!e)return;const r=Date.parse(e)-Date.now();return Number.isFinite(r)?Math.max(0,r):void 0}catch{return}}function Pr(t){return Number.isFinite(_t(t))}function _r(){return{name:"throttlingRetryStrategy",retry({response:t}){const e=_t(t);return Number.isFinite(e)?{retryAfterInMs:e}:{skipStrategy:!0}}}}const xr=1e3,Ir=1e3*64;function $r(t={}){var e,n;const r=(e=t.retryDelayInMs)!==null&&e!==void 0?e:xr,i=(n=t.maxRetryDelayInMs)!==null&&n!==void 0?n:Ir;return{name:"exponentialRetryStrategy",retry({retryCount:o,response:a,responseError:s}){const c=kr(s),l=c&&t.ignoreSystemErrors,u=Or(a),d=u&&t.ignoreHttpStatusCodes;return a&&(Pr(a)||!u)||d||l?{skipStrategy:!0}:s&&!c&&!u?{errorToThrow:s}:Mn(o,{retryDelayInMs:r,maxRetryDelayInMs:i})}}}function Or(t){return!!(t&&t.status!==void 0&&(t.status>=500||t.status===408)&&t.status!==501&&t.status!==505)}function kr(t){return t?t.code==="ETIMEDOUT"||t.code==="ESOCKETTIMEDOUT"||t.code==="ECONNREFUSED"||t.code==="ECONNRESET"||t.code==="ENOENT"||t.code==="ENOTFOUND":!1}const xt=K("core-rest-pipeline retryPolicy"),Nr="retryPolicy";function Dr(t,e={maxRetries:Be}){const n=e.logger||xt;return{name:Nr,async sendRequest(r,i){var o,a;let s,c,l=-1;e:for(;;){l+=1,s=void 0,c=void 0;try{n.info(`Retry ${l}: Attempting to send request`,r.requestId),s=await i(r),n.info(`Retry ${l}: Received a response from request`,r.requestId)}catch(u){if(n.error(`Retry ${l}: Received an error from request`,r.requestId),c=u,!u||c.name!=="RestError")throw u;s=c.response}if(!((o=r.abortSignal)===null||o===void 0)&&o.aborted)throw n.error(`Retry ${l}: Request aborted.`),new $e;if(l>=((a=e.maxRetries)!==null&&a!==void 0?a:Be)){if(n.info(`Retry ${l}: Maximum retries reached. Returning the last received response, or throwing the last received error.`),c)throw c;if(s)return s;throw new Error("Maximum retries reached with no response or error to throw")}n.info(`Retry ${l}: Processing ${t.length} retry strategies.`);t:for(const u of t){const d=u.logger||xt;d.info(`Retry ${l}: Processing retry strategy ${u.name}.`);const f=u.retry({retryCount:l,response:s,responseError:c});if(f.skipStrategy){d.info(`Retry ${l}: Skipped.`);continue t}const{errorToThrow:m,retryAfterInMs:h,redirectTo:g}=f;if(m)throw d.error(`Retry ${l}: Retry strategy ${u.name} throws error:`,m),m;if(h||h===0){d.info(`Retry ${l}: Retry strategy ${u.name} retries after ${h}`),await Pt(h,void 0,{abortSignal:r.abortSignal});continue e}if(g){d.info(`Retry ${l}: Retry strategy ${u.name} redirects to ${g}`),r.url=g;continue e}}if(c)throw n.info("None of the retry strategies could work with the received error. Throwing it."),c;if(s)return n.info("None of the retry strategies could work with the received response. Returning it."),s}}}}const Mr="defaultRetryPolicy";function zr(t={}){var e;return{name:Mr,sendRequest:Dr([_r(),$r(t)],{maxRetries:(e=t.maxRetries)!==null&&e!==void 0?e:Be}).sendRequest}}function re(t){return t.toLowerCase()}function*Ur(t){for(const e of t.values())yield[e.name,e.value]}class Lr{constructor(e){if(this._headersMap=new Map,e)for(const n of Object.keys(e))this.set(n,e[n])}set(e,n){this._headersMap.set(re(e),{name:e,value:String(n).trim()})}get(e){var n;return(n=this._headersMap.get(re(e)))===null||n===void 0?void 0:n.value}has(e){return this._headersMap.has(re(e))}delete(e){this._headersMap.delete(re(e))}toJSON(e={}){const n={};if(e.preserveCase)for(const r of this._headersMap.values())n[r.name]=r.value;else for(const[r,i]of this._headersMap)n[r]=i.value;return n}toString(){return JSON.stringify(this.toJSON({preserveCase:!0}))}[Symbol.iterator](){return Ur(this._headersMap)}}function O(t){return new Lr(t)}const Br="formDataPolicy";function Hr(t){var e;const n={};for(const[r,i]of t.entries())(e=n[r])!==null&&e!==void 0||(n[r]=[]),n[r].push(i);return n}function qr(){return{name:Br,async sendRequest(t,e){if(H&&typeof FormData<"u"&&t.body instanceof FormData&&(t.formData=Hr(t.body),t.body=void 0),t.formData){const n=t.headers.get("Content-Type");n&&n.indexOf("application/x-www-form-urlencoded")!==-1?t.body=Vr(t.formData):await Fr(t.formData,t),t.formData=void 0}return e(t)}}}function Vr(t){const e=new URLSearchParams;for(const[n,r]of Object.entries(t))if(Array.isArray(r))for(const i of r)e.append(n,i.toString());else e.append(n,r.toString());return e.toString()}async function Fr(t,e){const n=e.headers.get("Content-Type");if(n&&!n.startsWith("multipart/form-data"))return;e.headers.set("Content-Type",n??"multipart/form-data");const r=[];for(const[i,o]of Object.entries(t))for(const a of Array.isArray(o)?o:[o])if(typeof a=="string")r.push({headers:O({"Content-Disposition":`form-data; name="${i}"`}),body:$(a,"utf-8")});else{if(a==null||typeof a!="object")throw new Error(`Unexpected value for key ${i}: ${a}. Value should be serialized to string first.`);{const s=a.name||"blob",c=O();c.set("Content-Disposition",`form-data; name="${i}"; filename="${s}"`),c.set("Content-Type",a.type||"application/octet-stream"),r.push({headers:c,body:a})}}e.multipartBody={parts:r}}const Da="proxyPolicy",Ve="proxyPolicy is not supported in browser environment";function Ma(){throw new Error(Ve)}function Wr(){throw new Error(Ve)}function za(){throw new Error(Ve)}const jr="setClientRequestIdPolicy";function Kr(t="x-ms-client-request-id"){return{name:jr,async sendRequest(e,n){return e.headers.has(t)||e.headers.set(t,e.requestId),n(e)}}}const Xr="agentPolicy";function Yr(t){return{name:Xr,sendRequest:async(e,n)=>(e.agent||(e.agent=t),n(e))}}const Jr="tlsPolicy";function Gr(t){return{name:Jr,sendRequest:async(e,n)=>(e.tlsSettings||(e.tlsSettings=t),n(e))}}const Qr={},Zr=new Le;class _ extends Error{constructor(e,n={}){super(e),this.name="RestError",this.code=n.code,this.statusCode=n.statusCode,Object.defineProperty(this,"request",{value:n.request,enumerable:!1}),Object.defineProperty(this,"response",{value:n.response,enumerable:!1}),Object.setPrototypeOf(this,_.prototype)}[Qr](){return`RestError: ${this.message} 
 ${Zr.sanitize(Object.assign(Object.assign({},this),{request:this.request,response:this.response}))}`}}_.REQUEST_SEND_ERROR="REQUEST_SEND_ERROR",_.PARSE_ERROR="PARSE_ERROR";function It(t){return t instanceof _?!0:Oe(t)&&t.name==="RestError"}const ei="tracingPolicy";function ti(t={}){const e=Ct(t.userAgentPrefix),n=new Le({additionalAllowedQueryParameters:t.additionalAllowedQueryParameters}),r=ni();return{name:ei,async sendRequest(i,o){var a;if(!r)return o(i);const s=await e,c={"http.url":n.sanitizeUrl(i.url),"http.method":i.method,"http.user_agent":s,requestId:i.requestId};s&&(c["http.user_agent"]=s);const{span:l,tracingContext:u}=(a=ri(r,i,c))!==null&&a!==void 0?a:{};if(!l||!u)return o(i);try{const d=await r.withContext(u,o,i);return oi(l,d),d}catch(d){throw ii(l,d),d}}}}function ni(){try{return st({namespace:"",packageName:"@azure/core-rest-pipeline",packageVersion:At})}catch(t){N.warning(`Error when creating the TracingClient: ${Q(t)}`);return}}function ri(t,e,n){try{const{span:r,updatedOptions:i}=t.startSpan(`HTTP ${e.method}`,{tracingOptions:e.tracingOptions},{spanKind:"client",spanAttributes:n});if(!r.isRecording()){r.end();return}const o=t.createRequestHeaders(i.tracingOptions.tracingContext);for(const[a,s]of Object.entries(o))e.headers.set(a,s);return{span:r,tracingContext:i.tracingOptions.tracingContext}}catch(r){N.warning(`Skipping creating a tracing span due to an error: ${Q(r)}`);return}}function ii(t,e){try{t.setStatus({status:"error",error:Oe(e)?e:void 0}),It(e)&&e.statusCode&&t.setAttribute("http.status_code",e.statusCode),t.end()}catch(n){N.warning(`Skipping tracing span processing due to an error: ${Q(n)}`)}}function oi(t,e){try{t.setAttribute("http.status_code",e.status);const n=e.headers.get("x-ms-request-id");n&&t.setAttribute("serviceRequestId",n),e.status>=400&&t.setStatus({status:"error"}),t.end()}catch(n){N.warning(`Skipping tracing span processing due to an error: ${Q(n)}`)}}function ai(t){var e;const n=Xn();return H&&(t.agent&&n.addPolicy(Yr(t.agent)),t.tlsOptions&&n.addPolicy(Gr(t.tlsOptions)),n.addPolicy(Wr(t.proxyOptions)),n.addPolicy(Tr())),n.addPolicy(qr(),{beforePolicies:[Rt]}),n.addPolicy(lr(t.userAgentOptions)),n.addPolicy(Kr((e=t.telemetryOptions)===null||e===void 0?void 0:e.clientRequestIdHeaderName)),n.addPolicy(Cr(),{afterPhase:"Deserialize"}),n.addPolicy(zr(t.retryOptions),{phase:"Retry"}),n.addPolicy(ti(Object.assign(Object.assign({},t.userAgentOptions),t.loggingOptions)),{afterPhase:"Retry"}),H&&n.addPolicy(er(t.redirectOptions),{afterPhase:"Retry"}),n.addPolicy(Qn(t.loggingOptions),{afterPhase:"Sign"}),n}function si(t){return(typeof Blob=="function"||typeof Blob=="object")&&t instanceof Blob}class li{async sendRequest(e){if(new URL(e.url).protocol!=="https:"&&!e.allowInsecureConnection)throw new Error(`Cannot connect to ${e.url} while allowInsecureConnection is false.`);if(e.proxySettings)throw new Error("HTTP proxy is not supported in browser environment");try{return await ci(e)}catch(i){throw fi(i,e)}}}async function ci(t){const{abortController:e,abortControllerCleanup:n}=di(t);try{const r=hi(t.headers),{streaming:i,body:o}=gi(t),a=Object.assign(Object.assign({body:o,method:t.method,headers:r,signal:e.signal},"credentials"in Request.prototype?{credentials:t.withCredentials?"include":"same-origin"}:{}),"cache"in Request.prototype?{cache:"no-store"}:{});i&&(a.duplex="half");const s=await fetch(t.url,a);return si(t.body)&&t.onUploadProgress&&t.onUploadProgress({loadedBytes:t.body.size}),ui(s,t,n)}catch(r){throw n?.(),r}}async function ui(t,e,n){var r,i;const o=mi(t),a={request:e,headers:o,status:t.status},s=ne(t.body)?$t(t.body,{onProgress:e.onDownloadProgress,onEnd:n}):t.body;if(!((r=e.streamResponseStatusCodes)===null||r===void 0)&&r.has(Number.POSITIVE_INFINITY)||!((i=e.streamResponseStatusCodes)===null||i===void 0)&&i.has(a.status))if(e.enableBrowserStreams)a.browserStreamBody=s??void 0;else{const c=new Response(s);a.blobBody=c.blob(),n?.()}else{const c=new Response(s);a.bodyAsText=await c.text(),n?.()}return a}function di(t){const e=new AbortController;let n,r;if(t.abortSignal){if(t.abortSignal.aborted)throw new $e("The operation was aborted. Request has already been canceled.");r=i=>{i.type==="abort"&&e.abort()},t.abortSignal.addEventListener("abort",r),n=()=>{var i;r&&((i=t.abortSignal)===null||i===void 0||i.removeEventListener("abort",r))}}return t.timeout>0&&setTimeout(()=>{e.abort()},t.timeout),{abortController:e,abortControllerCleanup:n}}function fi(t,e){var n;return t&&t?.name==="AbortError"?t:new _(`Error sending request: ${t.message}`,{code:(n=t?.code)!==null&&n!==void 0?n:_.REQUEST_SEND_ERROR,request:e})}function hi(t){const e=new Headers;for(const[n,r]of t)e.append(n,r);return e}function mi(t){const e=O();for(const[n,r]of t.headers)e.set(n,r);return e}function gi(t){const e=typeof t.body=="function"?t.body():t.body;if(He(e))throw new Error("Node streams are not supported in browser environment.");return ne(e)?{streaming:!0,body:$t(e,{onProgress:t.onUploadProgress})}:{streaming:!1,body:e}}function $t(t,e={}){let n=0;const{onProgress:r,onEnd:i}=e;if(pi(t))return t.pipeThrough(new TransformStream({transform(o,a){if(o===null){a.terminate();return}a.enqueue(o),n+=o.length,r&&r({loadedBytes:n})},flush(){i?.()}}));{const o=t.getReader();return new ReadableStream({async pull(a){var s;const{done:c,value:l}=await o.read();if(c||!l){i?.(),a.close(),o.releaseLock();return}n+=(s=l?.length)!==null&&s!==void 0?s:0,a.enqueue(l),r&&r({loadedBytes:n})},cancel(a){return i?.(),o.cancel(a)}})}}function yi(){return new li}function pi(t){return t.pipeThrough!==void 0&&self.TransformStream!==void 0}function wi(){return yi()}class bi{constructor(e){var n,r,i,o,a,s,c;this.url=e.url,this.body=e.body,this.headers=(n=e.headers)!==null&&n!==void 0?n:O(),this.method=(r=e.method)!==null&&r!==void 0?r:"GET",this.timeout=(i=e.timeout)!==null&&i!==void 0?i:0,this.multipartBody=e.multipartBody,this.formData=e.formData,this.disableKeepAlive=(o=e.disableKeepAlive)!==null&&o!==void 0?o:!1,this.proxySettings=e.proxySettings,this.streamResponseStatusCodes=e.streamResponseStatusCodes,this.withCredentials=(a=e.withCredentials)!==null&&a!==void 0?a:!1,this.abortSignal=e.abortSignal,this.tracingOptions=e.tracingOptions,this.onUploadProgress=e.onUploadProgress,this.onDownloadProgress=e.onDownloadProgress,this.requestId=e.requestId||yt(),this.allowInsecureConnection=(s=e.allowInsecureConnection)!==null&&s!==void 0?s:!1,this.enableBrowserStreams=(c=e.enableBrowserStreams)!==null&&c!==void 0?c:!1,this.agent=e.agent,this.tlsSettings=e.tlsSettings}}function ie(t){return new bi(t)}const Ua="exponentialRetryPolicy";function La(t={}){var e;return retryPolicy([exponentialRetryStrategy(Object.assign(Object.assign({},t),{ignoreSystemErrors:!0}))],{maxRetries:(e=t.maxRetries)!==null&&e!==void 0?e:DEFAULT_RETRY_POLICY_COUNT})}const vi="systemErrorRetryPolicy";function Ba(t={}){var e;return{name:vi,sendRequest:retryPolicy([exponentialRetryStrategy(Object.assign(Object.assign({},t),{ignoreHttpStatusCodes:!0}))],{maxRetries:(e=t.maxRetries)!==null&&e!==void 0?e:DEFAULT_RETRY_POLICY_COUNT}).sendRequest}}const Ai="throttlingRetryPolicy";function Ha(t={}){var e;return{name:Ai,sendRequest:retryPolicy([throttlingRetryStrategy()],{maxRetries:(e=t.maxRetries)!==null&&e!==void 0?e:DEFAULT_RETRY_POLICY_COUNT}).sendRequest}}const Ci={forcedRefreshWindowInMs:1e3,retryIntervalInMs:3e3,refreshWindowInMs:1e3*60*2};async function Ti(t,e,n){async function r(){if(Date.now()<n)try{return await t()}catch{return null}else{const o=await t();if(o===null)throw new Error("Failed to refresh access token.");return o}}let i=await r();for(;i===null;)await Pt(e),i=await r();return i}function Si(t,e){let n=null,r=null,i;const o=Object.assign(Object.assign({},Ci),e),a={get isRefreshing(){return n!==null},get shouldRefresh(){var c;return a.isRefreshing?!1:r?.refreshAfterTimestamp&&r.refreshAfterTimestamp<Date.now()?!0:((c=r?.expiresOnTimestamp)!==null&&c!==void 0?c:0)-o.refreshWindowInMs<Date.now()},get mustRefresh(){return r===null||r.expiresOnTimestamp-o.forcedRefreshWindowInMs<Date.now()}};function s(c,l){var u;return a.isRefreshing||(n=Ti(()=>t.getToken(c,l),o.retryIntervalInMs,(u=r?.expiresOnTimestamp)!==null&&u!==void 0?u:Date.now()).then(f=>(n=null,r=f,i=l.tenantId,r)).catch(f=>{throw n=null,r=null,i=void 0,f})),n}return async(c,l)=>{const u=!!l.claims,d=i!==l.tenantId;return u&&(r=null),d||u||a.mustRefresh?s(c,l):(a.shouldRefresh&&s(c,l),r)}}const Ei="bearerTokenAuthenticationPolicy";async function oe(t,e){try{return[await e(t),void 0]}catch(n){if(It(n)&&n.response)return[n.response,n];throw n}}async function Ri(t){const{scopes:e,getAccessToken:n,request:r}=t,i={abortSignal:r.abortSignal,tracingOptions:r.tracingOptions,enableCae:!0},o=await n(e,i);o&&t.request.headers.set("Authorization",`Bearer ${o.token}`)}function Ot(t){return t.status===401&&t.headers.has("WWW-Authenticate")}async function kt(t,e){var n;const{scopes:r}=t,i=await t.getAccessToken(r,{enableCae:!0,claims:e});return i?(t.request.headers.set("Authorization",`${(n=i.tokenType)!==null&&n!==void 0?n:"Bearer"} ${i.token}`),!0):!1}function Pi(t){var e,n,r;const{credential:i,scopes:o,challengeCallbacks:a}=t,s=t.logger||N,c={authorizeRequest:(n=(e=a?.authorizeRequest)===null||e===void 0?void 0:e.bind(a))!==null&&n!==void 0?n:Ri,authorizeRequestOnChallenge:(r=a?.authorizeRequestOnChallenge)===null||r===void 0?void 0:r.bind(a)},l=i?Si(i):()=>Promise.resolve(null);return{name:Ei,async sendRequest(u,d){if(!u.url.toLowerCase().startsWith("https://"))throw new Error("Bearer token authentication is not permitted for non-TLS protected (non-https) URLs.");await c.authorizeRequest({scopes:Array.isArray(o)?o:[o],request:u,getAccessToken:l,logger:s});let f,m,h;if([f,m]=await oe(u,d),Ot(f)){let g=Nt(f.headers.get("WWW-Authenticate"));if(g){let p;try{p=atob(g)}catch{return s.warning(`The WWW-Authenticate header contains "claims" that cannot be parsed. Unable to perform the Continuous Access Evaluation authentication flow. Unparsable claims: ${g}`),f}h=await kt({scopes:Array.isArray(o)?o:[o],response:f,request:u,getAccessToken:l,logger:s},p),h&&([f,m]=await oe(u,d))}else if(c.authorizeRequestOnChallenge&&(h=await c.authorizeRequestOnChallenge({scopes:Array.isArray(o)?o:[o],request:u,response:f,getAccessToken:l,logger:s}),h&&([f,m]=await oe(u,d)),Ot(f)&&(g=Nt(f.headers.get("WWW-Authenticate")),g))){let p;try{p=atob(g)}catch{return s.warning(`The WWW-Authenticate header contains "claims" that cannot be parsed. Unable to perform the Continuous Access Evaluation authentication flow. Unparsable claims: ${g}`),f}h=await kt({scopes:Array.isArray(o)?o:[o],response:f,request:u,getAccessToken:l,logger:s},p),h&&([f,m]=await oe(u,d))}}if(m)throw m;return f}}}function _i(t){const e=/(\w+)\s+((?:\w+=(?:"[^"]*"|[^,]*),?\s*)+)/g,n=/(\w+)="([^"]*)"/g,r=[];let i;for(;(i=e.exec(t))!==null;){const o=i[1],a=i[2],s={};let c;for(;(c=n.exec(a))!==null;)s[c[1]]=c[2];r.push({scheme:o,params:s})}return r}function Nt(t){var e;return t?(e=_i(t).find(r=>r.scheme==="Bearer"&&r.params.claims&&r.params.error==="insufficient_claims"))===null||e===void 0?void 0:e.params.claims:void 0}const Dt="auxiliaryAuthenticationHeaderPolicy",Mt="x-ms-authorization-auxiliary";async function xi(t){var e,n;const{scopes:r,getAccessToken:i,request:o}=t,a={abortSignal:o.abortSignal,tracingOptions:o.tracingOptions};return(n=(e=await i(r,a))===null||e===void 0?void 0:e.token)!==null&&n!==void 0?n:""}function qa(t){const{credentials:e,scopes:n}=t,r=t.logger||coreLogger,i=new WeakMap;return{name:Dt,async sendRequest(o,a){if(!o.url.toLowerCase().startsWith("https://"))throw new Error("Bearer token authentication for auxiliary header is not permitted for non-TLS protected (non-https) URLs.");if(!e||e.length===0)return r.info(`${Dt} header will not be set due to empty credentials.`),a(o);const s=[];for(const l of e){let u=i.get(l);u||(u=createTokenCycler(l),i.set(l,u)),s.push(xi({scopes:Array.isArray(n)?n:[n],request:o,getAccessToken:u,logger:r}))}const c=(await Promise.all(s)).filter(l=>!!l);return c.length===0?(r.warning(`None of the auxiliary tokens are valid. ${Mt} header will not be set.`),a(o)):(o.headers.set(Mt,c.map(l=>`Bearer ${l}`).join(", ")),a(o))}}}function Ii(t,e){if(!e.match(/^[0-9a-zA-Z-.]+$/)){const n=new Error("Invalid tenant id provided. You can locate your tenant id by following the instructions listed here: https://learn.microsoft.com/partner-center/find-ids-and-domain-names.");throw t.info(formatError("",n)),n}}function Va(t,e,n){return e?(Ii(t,e),e):(n||(n=DeveloperSignOnClientId),n!==DeveloperSignOnClientId?"common":"organizations")}function Fa(t){return!t||t.length===0?[]:t.includes("*")?ALL_TENANTS:t}class $i{constructor(e={},n=!1){this.modelMappers=e,this.isXML=n}validateConstraints(e,n,r){const i=(o,a)=>{throw new Error(`"${r}" with value "${n}" should satisfy the constraint "${o}": ${a}.`)};if(e.constraints&&n!==void 0&&n!==null){const{ExclusiveMaximum:o,ExclusiveMinimum:a,InclusiveMaximum:s,InclusiveMinimum:c,MaxItems:l,MaxLength:u,MinItems:d,MinLength:f,MultipleOf:m,Pattern:h,UniqueItems:g}=e.constraints;if(o!==void 0&&n>=o&&i("ExclusiveMaximum",o),a!==void 0&&n<=a&&i("ExclusiveMinimum",a),s!==void 0&&n>s&&i("InclusiveMaximum",s),c!==void 0&&n<c&&i("InclusiveMinimum",c),l!==void 0&&n.length>l&&i("MaxItems",l),u!==void 0&&n.length>u&&i("MaxLength",u),d!==void 0&&n.length<d&&i("MinItems",d),f!==void 0&&n.length<f&&i("MinLength",f),m!==void 0&&n%m!==0&&i("MultipleOf",m),h){const p=typeof h=="string"?new RegExp(h):h;(typeof n!="string"||n.match(p)===null)&&i("Pattern",h)}g&&n.some((p,v,A)=>A.indexOf(p)!==v)&&i("UniqueItems",g)}}serialize(e,n,r,i={xml:{}}){var o,a,s;const c={xml:{rootName:(o=i.xml.rootName)!==null&&o!==void 0?o:"",includeRoot:(a=i.xml.includeRoot)!==null&&a!==void 0?a:!1,xmlCharKey:(s=i.xml.xmlCharKey)!==null&&s!==void 0?s:XML_CHARKEY}};let l={};const u=e.type.name;r||(r=e.serializedName),u.match(/^Sequence$/i)!==null&&(l=[]),e.isConstant&&(n=e.defaultValue);const{required:d,nullable:f}=e;if(d&&f&&n===void 0)throw new Error(`${r} cannot be undefined.`);if(d&&!f&&n==null)throw new Error(`${r} cannot be null or undefined.`);if(!d&&f===!1&&n===null)throw new Error(`${r} cannot be null.`);return n==null||u.match(/^any$/i)!==null?l=n:u.match(/^(Number|String|Boolean|Object|Stream|Uuid)$/i)!==null?l=zi(u,r,n):u.match(/^Enum$/i)!==null?l=Ui(r,e.type.allowedValues,n):u.match(/^(Date|DateTime|TimeSpan|DateTimeRfc1123|UnixTime)$/i)!==null?l=Hi(u,n,r):u.match(/^ByteArray$/i)!==null?l=Li(r,n):u.match(/^Base64Url$/i)!==null?l=Bi(r,n):u.match(/^Sequence$/i)!==null?l=qi(this,e,n,r,!!this.isXML,c):u.match(/^Dictionary$/i)!==null?l=Vi(this,e,n,r,!!this.isXML,c):u.match(/^Composite$/i)!==null&&(l=Wi(this,e,n,r,!!this.isXML,c)),l}deserialize(e,n,r,i={xml:{}}){var o,a,s,c;const l={xml:{rootName:(o=i.xml.rootName)!==null&&o!==void 0?o:"",includeRoot:(a=i.xml.includeRoot)!==null&&a!==void 0?a:!1,xmlCharKey:(s=i.xml.xmlCharKey)!==null&&s!==void 0?s:XML_CHARKEY},ignoreUnknownProperties:(c=i.ignoreUnknownProperties)!==null&&c!==void 0?c:!1};if(n==null)return this.isXML&&e.type.name==="Sequence"&&!e.xmlIsWrapped&&(n=[]),e.defaultValue!==void 0&&(n=e.defaultValue),n;let u;const d=e.type.name;if(r||(r=e.serializedName),d.match(/^Composite$/i)!==null)u=Ki(this,e,n,r,l);else{if(this.isXML){const f=l.xml.xmlCharKey;n[XML_ATTRKEY]!==void 0&&n[f]!==void 0&&(n=n[f])}d.match(/^Number$/i)!==null?(u=parseFloat(n),isNaN(u)&&(u=n)):d.match(/^Boolean$/i)!==null?n==="true"?u=!0:n==="false"?u=!1:u=n:d.match(/^(String|Enum|Object|Stream|Uuid|TimeSpan|any)$/i)!==null?u=n:d.match(/^(Date|DateTime|DateTimeRfc1123)$/i)!==null?u=new Date(n):d.match(/^UnixTime$/i)!==null?u=Mi(n):d.match(/^ByteArray$/i)!==null?u=base64.decodeString(n):d.match(/^Base64Url$/i)!==null?u=Ni(n):d.match(/^Sequence$/i)!==null?u=Yi(this,e,n,r,l):d.match(/^Dictionary$/i)!==null&&(u=Xi(this,e,n,r,l))}return e.isConstant&&(u=e.defaultValue),u}}function Wa(t={},e=!1){return new $i(t,e)}function Oi(t,e){let n=t.length;for(;n-1>=0&&t[n-1]===e;)--n;return t.substr(0,n)}function ki(t){if(!t)return;if(!(t instanceof Uint8Array))throw new Error("Please provide an input of type Uint8Array for converting to Base64Url.");const e=base64.encodeByteArray(t);return Oi(e,"=").replace(/\+/g,"-").replace(/\//g,"_")}function Ni(t){if(t){if(t&&typeof t.valueOf()!="string")throw new Error("Please provide an input of type string for converting to Uint8Array");return t=t.replace(/-/g,"+").replace(/_/g,"/"),base64.decodeString(t)}}function Fe(t){const e=[];let n="";if(t){const r=t.split(".");for(const i of r)i.charAt(i.length-1)==="\\"?n+=i.substr(0,i.length-1)+".":(n+=i,e.push(n),n="")}return e}function Di(t){if(t)return typeof t.valueOf()=="string"&&(t=new Date(t)),Math.floor(t.getTime()/1e3)}function Mi(t){if(t)return new Date(t*1e3)}function zi(t,e,n){if(n!=null){if(t.match(/^Number$/i)!==null){if(typeof n!="number")throw new Error(`${e} with value ${n} must be of type number.`)}else if(t.match(/^String$/i)!==null){if(typeof n.valueOf()!="string")throw new Error(`${e} with value "${n}" must be of type string.`)}else if(t.match(/^Uuid$/i)!==null){if(!(typeof n.valueOf()=="string"&&isValidUuid(n)))throw new Error(`${e} with value "${n}" must be of type string and a valid uuid.`)}else if(t.match(/^Boolean$/i)!==null){if(typeof n!="boolean")throw new Error(`${e} with value ${n} must be of type boolean.`)}else if(t.match(/^Stream$/i)!==null){const r=typeof n;if(r!=="string"&&typeof n.pipe!="function"&&typeof n.tee!="function"&&!(n instanceof ArrayBuffer)&&!ArrayBuffer.isView(n)&&!((typeof Blob=="function"||typeof Blob=="object")&&n instanceof Blob)&&r!=="function")throw new Error(`${e} must be a string, Blob, ArrayBuffer, ArrayBufferView, ReadableStream, or () => ReadableStream.`)}}return n}function Ui(t,e,n){if(!e)throw new Error(`Please provide a set of allowedValues to validate ${t} as an Enum Type.`);if(!e.some(i=>typeof i.valueOf()=="string"?i.toLowerCase()===n.toLowerCase():i===n))throw new Error(`${n} is not a valid value for ${t}. The valid values are: ${JSON.stringify(e)}.`);return n}function Li(t,e){if(e!=null){if(!(e instanceof Uint8Array))throw new Error(`${t} must be of type Uint8Array.`);e=base64.encodeByteArray(e)}return e}function Bi(t,e){if(e!=null){if(!(e instanceof Uint8Array))throw new Error(`${t} must be of type Uint8Array.`);e=ki(e)}return e}function Hi(t,e,n){if(e!=null){if(t.match(/^Date$/i)!==null){if(!(e instanceof Date||typeof e.valueOf()=="string"&&!isNaN(Date.parse(e))))throw new Error(`${n} must be an instanceof Date or a string in ISO8601 format.`);e=e instanceof Date?e.toISOString().substring(0,10):new Date(e).toISOString().substring(0,10)}else if(t.match(/^DateTime$/i)!==null){if(!(e instanceof Date||typeof e.valueOf()=="string"&&!isNaN(Date.parse(e))))throw new Error(`${n} must be an instanceof Date or a string in ISO8601 format.`);e=e instanceof Date?e.toISOString():new Date(e).toISOString()}else if(t.match(/^DateTimeRfc1123$/i)!==null){if(!(e instanceof Date||typeof e.valueOf()=="string"&&!isNaN(Date.parse(e))))throw new Error(`${n} must be an instanceof Date or a string in RFC-1123 format.`);e=e instanceof Date?e.toUTCString():new Date(e).toUTCString()}else if(t.match(/^UnixTime$/i)!==null){if(!(e instanceof Date||typeof e.valueOf()=="string"&&!isNaN(Date.parse(e))))throw new Error(`${n} must be an instanceof Date or a string in RFC-1123/ISO8601 format for it to be serialized in UnixTime/Epoch format.`);e=Di(e)}else if(t.match(/^TimeSpan$/i)!==null&&!isDuration(e))throw new Error(`${n} must be a string in ISO 8601 format. Instead was "${e}".`)}return e}function qi(t,e,n,r,i,o){var a;if(!Array.isArray(n))throw new Error(`${r} must be of type Array.`);let s=e.type.element;if(!s||typeof s!="object")throw new Error(`element" metadata for an Array must be defined in the mapper and it must of type "object" in ${r}.`);s.type.name==="Composite"&&s.type.className&&(s=(a=t.modelMappers[s.type.className])!==null&&a!==void 0?a:s);const c=[];for(let l=0;l<n.length;l++){const u=t.serialize(s,n[l],r,o);if(i&&s.xmlNamespace){const d=s.xmlNamespacePrefix?`xmlns:${s.xmlNamespacePrefix}`:"xmlns";s.type.name==="Composite"?(c[l]=Object.assign({},u),c[l][XML_ATTRKEY]={[d]:s.xmlNamespace}):(c[l]={},c[l][o.xml.xmlCharKey]=u,c[l][XML_ATTRKEY]={[d]:s.xmlNamespace})}else c[l]=u}return c}function Vi(t,e,n,r,i,o){if(typeof n!="object")throw new Error(`${r} must be of type object.`);const a=e.type.value;if(!a||typeof a!="object")throw new Error(`"value" metadata for a Dictionary must be defined in the mapper and it must of type "object" in ${r}.`);const s={};for(const c of Object.keys(n)){const l=t.serialize(a,n[c],r,o);s[c]=Lt(a,l,i,o)}if(i&&e.xmlNamespace){const c=e.xmlNamespacePrefix?`xmlns:${e.xmlNamespacePrefix}`:"xmlns",l=s;return l[XML_ATTRKEY]={[c]:e.xmlNamespace},l}return s}function Fi(t,e,n){const r=e.type.additionalProperties;if(!r&&e.type.className){const i=zt(t,e,n);return i?.type.additionalProperties}return r}function zt(t,e,n){const r=e.type.className;if(!r)throw new Error(`Class name for model "${n}" is not provided in the mapper "${JSON.stringify(e,void 0,2)}".`);return t.modelMappers[r]}function Ut(t,e,n){let r=e.type.modelProperties;if(!r){const i=zt(t,e,n);if(!i)throw new Error(`mapper() cannot be null or undefined for model "${e.type.className}".`);if(r=i?.type.modelProperties,!r)throw new Error(`modelProperties cannot be null or undefined in the mapper "${JSON.stringify(i)}" of type "${e.type.className}" for object "${n}".`)}return r}function Wi(t,e,n,r,i,o){if(ae(t,e)&&(e=Bt(t,e,n,"clientName")),n!=null){const a={},s=Ut(t,e,r);for(const l of Object.keys(s)){const u=s[l];if(u.readOnly)continue;let d,f=a;if(t.isXML)u.xmlIsWrapped?d=u.xmlName:d=u.xmlElementName||u.xmlName;else{const m=Fe(u.serializedName);d=m.pop();for(const h of m){const g=f[h];g==null&&(n[l]!==void 0&&n[l]!==null||u.defaultValue!==void 0)&&(f[h]={}),f=f[h]}}if(f!=null){if(i&&e.xmlNamespace){const v=e.xmlNamespacePrefix?`xmlns:${e.xmlNamespacePrefix}`:"xmlns";f[XML_ATTRKEY]=Object.assign(Object.assign({},f[XML_ATTRKEY]),{[v]:e.xmlNamespace})}const m=u.serializedName!==""?r+"."+u.serializedName:r;let h=n[l];const g=ae(t,e);g&&g.clientName===l&&h==null&&(h=e.serializedName);const p=t.serialize(u,h,m,o);if(p!==void 0&&d!==void 0&&d!==null){const v=Lt(u,p,i,o);i&&u.xmlIsAttribute?(f[XML_ATTRKEY]=f[XML_ATTRKEY]||{},f[XML_ATTRKEY][d]=p):i&&u.xmlIsWrapped?f[d]={[u.xmlElementName]:v}:f[d]=v}}}const c=Fi(t,e,r);if(c){const l=Object.keys(s);for(const u in n)l.every(f=>f!==u)&&(a[u]=t.serialize(c,n[u],r+'["'+u+'"]',o))}return a}return n}function Lt(t,e,n,r){if(!n||!t.xmlNamespace)return e;const o={[t.xmlNamespacePrefix?`xmlns:${t.xmlNamespacePrefix}`:"xmlns"]:t.xmlNamespace};if(["Composite"].includes(t.type.name)){if(e[XML_ATTRKEY])return e;{const s=Object.assign({},e);return s[XML_ATTRKEY]=o,s}}const a={};return a[r.xml.xmlCharKey]=e,a[XML_ATTRKEY]=o,a}function ji(t,e){return[XML_ATTRKEY,e.xml.xmlCharKey].includes(t)}function Ki(t,e,n,r,i){var o,a;const s=(o=i.xml.xmlCharKey)!==null&&o!==void 0?o:XML_CHARKEY;ae(t,e)&&(e=Bt(t,e,n,"serializedName"));const c=Ut(t,e,r);let l={};const u=[];for(const f of Object.keys(c)){const m=c[f],h=Fe(c[f].serializedName);u.push(h[0]);const{serializedName:g,xmlName:p,xmlElementName:v}=m;let A=r;g!==""&&g!==void 0&&(A=r+"."+g);const R=m.headerCollectionPrefix;if(R){const b={};for(const C of Object.keys(n))C.startsWith(R)&&(b[C.substring(R.length)]=t.deserialize(m.type.value,n[C],A,i)),u.push(C);l[f]=b}else if(t.isXML)if(m.xmlIsAttribute&&n[XML_ATTRKEY])l[f]=t.deserialize(m,n[XML_ATTRKEY][p],A,i);else if(m.xmlIsMsText)n[s]!==void 0?l[f]=n[s]:typeof n=="string"&&(l[f]=n);else{const b=v||p||g;if(m.xmlIsWrapped){const C=n[p],w=(a=C?.[v])!==null&&a!==void 0?a:[];l[f]=t.deserialize(m,w,A,i),u.push(p)}else{const C=n[b];l[f]=t.deserialize(m,C,A,i),u.push(b)}}else{let b,C=n,w=0;for(const T of h){if(!C)break;w++,C=C[T]}C===null&&w<h.length&&(C=void 0),b=C;const y=e.type.polymorphicDiscriminator;y&&f===y.clientName&&b==null&&(b=e.serializedName);let S;if(Array.isArray(n[f])&&c[f].serializedName===""){b=n[f];const T=t.deserialize(m,b,A,i);for(const[x,Ke]of Object.entries(l))Object.prototype.hasOwnProperty.call(T,x)||(T[x]=Ke);l=T}else(b!==void 0||m.defaultValue!==void 0)&&(S=t.deserialize(m,b,A,i),l[f]=S)}}const d=e.type.additionalProperties;if(d){const f=m=>{for(const h in c)if(Fe(c[h].serializedName)[0]===m)return!1;return!0};for(const m in n)f(m)&&(l[m]=t.deserialize(d,n[m],r+'["'+m+'"]',i))}else if(n&&!i.ignoreUnknownProperties)for(const f of Object.keys(n))l[f]===void 0&&!u.includes(f)&&!ji(f,i)&&(l[f]=n[f]);return l}function Xi(t,e,n,r,i){const o=e.type.value;if(!o||typeof o!="object")throw new Error(`"value" metadata for a Dictionary must be defined in the mapper and it must of type "object" in ${r}`);if(n){const a={};for(const s of Object.keys(n))a[s]=t.deserialize(o,n[s],r,i);return a}return n}function Yi(t,e,n,r,i){var o;let a=e.type.element;if(!a||typeof a!="object")throw new Error(`element" metadata for an Array must be defined in the mapper and it must of type "object" in ${r}`);if(n){Array.isArray(n)||(n=[n]),a.type.name==="Composite"&&a.type.className&&(a=(o=t.modelMappers[a.type.className])!==null&&o!==void 0?o:a);const s=[];for(let c=0;c<n.length;c++)s[c]=t.deserialize(a,n[c],`${r}[${c}]`,i);return s}return n}function Ji(t,e,n){const r=[n];for(;r.length;){const i=r.shift(),o=e===i?e:i+"."+e;if(Object.prototype.hasOwnProperty.call(t,o))return t[o];for(const[a,s]of Object.entries(t))a.startsWith(i+".")&&s.type.uberParent===i&&s.type.className&&r.push(s.type.className)}}function Bt(t,e,n,r){var i;const o=ae(t,e);if(o){let a=o[r];if(a){r==="serializedName"&&(a=a.replace(/\\/gi,""));const s=n[a],c=(i=e.type.uberParent)!==null&&i!==void 0?i:e.type.className;if(typeof s=="string"&&c){const l=Ji(t.modelMappers.discriminators,s,c);l&&(e=l)}}}return e}function ae(t,e){return e.type.polymorphicDiscriminator||Ht(t,e.type.uberParent)||Ht(t,e.type.className)}function Ht(t,e){return e&&t.modelMappers[e]&&t.modelMappers[e].type.polymorphicDiscriminator}const D={Base64Url:"Base64Url",Boolean:"Boolean",ByteArray:"ByteArray",Composite:"Composite",Date:"Date",DateTime:"DateTime",DateTimeRfc1123:"DateTimeRfc1123",Dictionary:"Dictionary",Enum:"Enum",Number:"Number",Object:"Object",Sequence:"Sequence",String:"String",Stream:"Stream",TimeSpan:"TimeSpan",UnixTime:"UnixTime"},qt="$",Vt="_",Ft={operationRequestMap:new WeakMap};function M(t,e,n){let r=e.parameterPath;const i=e.mapper;let o;if(typeof r=="string"&&(r=[r]),Array.isArray(r)){if(r.length>0)if(i.isConstant)o=i.defaultValue;else{let a=Wt(t,r);!a.propertyFound&&n&&(a=Wt(n,r));let s=!1;a.propertyFound||(s=i.required||r[0]==="options"&&r.length===2),o=s?i.defaultValue:a.propertyValue}}else{i.required&&(o={});for(const a in r){const s=i.type.modelProperties[a],c=r[a],l=M(t,{parameterPath:c,mapper:s},n);l!==void 0&&(o||(o={}),o[a]=l)}}return o}function Wt(t,e){const n={propertyFound:!1};let r=0;for(;r<e.length;++r){const i=e[r];if(t&&i in t)t=t[i];else break}return r===e.length&&(n.propertyValue=t,n.propertyFound=!0),n}const jt=Symbol.for("@azure/core-client original request");function Gi(t){return jt in t}function z(t){if(Gi(t))return z(t[jt]);let e=Ft.operationRequestMap.get(t);return e||(e={},Ft.operationRequestMap.set(t,e)),e}const Qi=["application/json","text/json"],Zi=["application/xml","application/atom+xml"],eo="deserializationPolicy";function to(t={}){var e,n,r,i,o,a,s;const c=(n=(e=t.expectedContentTypes)===null||e===void 0?void 0:e.json)!==null&&n!==void 0?n:Qi,l=(i=(r=t.expectedContentTypes)===null||r===void 0?void 0:r.xml)!==null&&i!==void 0?i:Zi,u=t.parseXML,d=t.serializerOptions,f={xml:{rootName:(o=d?.xml.rootName)!==null&&o!==void 0?o:"",includeRoot:(a=d?.xml.includeRoot)!==null&&a!==void 0?a:!1,xmlCharKey:(s=d?.xml.xmlCharKey)!==null&&s!==void 0?s:Vt}};return{name:eo,async sendRequest(m,h){const g=await h(m);return io(c,l,g,f,u)}}}function no(t){let e;const n=t.request,r=z(n),i=r?.operationSpec;return i&&(r?.operationResponseGetter?e=r?.operationResponseGetter(i,t):e=i.responses[t.status]),e}function ro(t){const e=t.request,n=z(e),r=n?.shouldDeserialize;let i;return r===void 0?i=!0:typeof r=="boolean"?i=r:i=r(t),i}async function io(t,e,n,r,i){const o=await so(t,e,n,r,i);if(!ro(o))return o;const a=z(o.request),s=a?.operationSpec;if(!s||!s.responses)return o;const c=no(o),{error:l,shouldReturnResponse:u}=ao(o,s,c,r);if(l)throw l;if(u)return o;if(c){if(c.bodyMapper){let d=o.parsedBody;s.isXML&&c.bodyMapper.type.name===D.Sequence&&(d=typeof d=="object"?d[c.bodyMapper.xmlElementName]:[]);try{o.parsedBody=s.serializer.deserialize(c.bodyMapper,d,"operationRes.parsedBody",r)}catch(f){throw new _(`Error ${f} occurred in deserializing the responseBody - ${o.bodyAsText}`,{statusCode:o.status,request:o.request,response:o})}}else s.httpMethod==="HEAD"&&(o.parsedBody=n.status>=200&&n.status<300);c.headersMapper&&(o.parsedHeaders=s.serializer.deserialize(c.headersMapper,o.headers.toJSON(),"operationRes.parsedHeaders",{xml:{},ignoreUnknownProperties:!0}))}return o}function oo(t){const e=Object.keys(t.responses);return e.length===0||e.length===1&&e[0]==="default"}function ao(t,e,n,r){var i,o,a,s,c;const l=200<=t.status&&t.status<300;if(oo(e)?l:!!n)if(n){if(!n.isError)return{error:null,shouldReturnResponse:!1}}else return{error:null,shouldReturnResponse:!1};const d=n??e.responses.default,f=!((i=t.request.streamResponseStatusCodes)===null||i===void 0)&&i.has(t.status)?`Unexpected status code: ${t.status}`:t.bodyAsText,m=new _(f,{statusCode:t.status,request:t.request,response:t});if(!d&&!(!((a=(o=t.parsedBody)===null||o===void 0?void 0:o.error)===null||a===void 0)&&a.code&&(!((c=(s=t.parsedBody)===null||s===void 0?void 0:s.error)===null||c===void 0)&&c.message)))throw m;const h=d?.bodyMapper,g=d?.headersMapper;try{if(t.parsedBody){const p=t.parsedBody;let v;if(h){let R=p;if(e.isXML&&h.type.name===D.Sequence){R=[];const b=h.xmlElementName;typeof p=="object"&&b&&(R=p[b])}v=e.serializer.deserialize(h,R,"error.response.parsedBody",r)}const A=p.error||v||p;m.code=A.code,A.message&&(m.message=A.message),h&&(m.response.parsedBody=v)}t.headers&&g&&(m.response.parsedHeaders=e.serializer.deserialize(g,t.headers.toJSON(),"operationRes.parsedHeaders"))}catch(p){m.message=`Error "${p.message}" occurred in deserializing the responseBody - "${t.bodyAsText}" for the default response.`}return{error:m,shouldReturnResponse:!1}}async function so(t,e,n,r,i){var o;if(!(!((o=n.request.streamResponseStatusCodes)===null||o===void 0)&&o.has(n.status))&&n.bodyAsText){const a=n.bodyAsText,s=n.headers.get("Content-Type")||"",c=s?s.split(";").map(l=>l.toLowerCase()):[];try{if(c.length===0||c.some(l=>t.indexOf(l)!==-1))return n.parsedBody=JSON.parse(a),n;if(c.some(l=>e.indexOf(l)!==-1)){if(!i)throw new Error("Parsing XML not supported.");const l=await i(a,r.xml);return n.parsedBody=l,n}}catch(l){const u=`Error "${l}" occurred while parsing the response body - ${n.bodyAsText}.`,d=l.code||_.PARSE_ERROR;throw new _(u,{code:d,statusCode:n.status,request:n.request,response:n})}}return n}function lo(t){const e=new Set;for(const n in t.responses){const r=t.responses[n];r.bodyMapper&&r.bodyMapper.type.name===D.Stream&&e.add(Number(n))}return e}function I(t){const{parameterPath:e,mapper:n}=t;let r;return typeof e=="string"?r=e:Array.isArray(e)?r=e.join("."):r=n.serializedName,r}const co="serializationPolicy";function uo(t={}){const e=t.stringifyXML;return{name:co,async sendRequest(n,r){const i=z(n),o=i?.operationSpec,a=i?.operationArguments;return o&&a&&(fo(n,a,o),ho(n,a,o,e)),r(n)}}}function fo(t,e,n){var r,i;if(n.headerParameters)for(const a of n.headerParameters){let s=M(e,a);if(s!=null||a.mapper.required){s=n.serializer.serialize(a.mapper,s,I(a));const c=a.mapper.headerCollectionPrefix;if(c)for(const l of Object.keys(s))t.headers.set(c+l,s[l]);else t.headers.set(a.mapper.serializedName||I(a),s)}}const o=(i=(r=e.options)===null||r===void 0?void 0:r.requestOptions)===null||i===void 0?void 0:i.customHeaders;if(o)for(const a of Object.keys(o))t.headers.set(a,o[a])}function ho(t,e,n,r=function(){throw new Error("XML serialization unsupported!")}){var i,o,a,s,c;const l=(i=e.options)===null||i===void 0?void 0:i.serializerOptions,u={xml:{rootName:(o=l?.xml.rootName)!==null&&o!==void 0?o:"",includeRoot:(a=l?.xml.includeRoot)!==null&&a!==void 0?a:!1,xmlCharKey:(s=l?.xml.xmlCharKey)!==null&&s!==void 0?s:Vt}},d=u.xml.xmlCharKey;if(n.requestBody&&n.requestBody.mapper){t.body=M(e,n.requestBody);const f=n.requestBody.mapper,{required:m,serializedName:h,xmlName:g,xmlElementName:p,xmlNamespace:v,xmlNamespacePrefix:A,nullable:R}=f,b=f.type.name;try{if(t.body!==void 0&&t.body!==null||R&&t.body===null||m){const C=I(n.requestBody);t.body=n.serializer.serialize(f,t.body,C,u);const w=b===D.Stream;if(n.isXML){const y=A?`xmlns:${A}`:"xmlns",S=mo(v,y,b,t.body,u);b===D.Sequence?t.body=r(go(S,p||g||h,y,v),{rootName:g||h,xmlCharKey:d}):w||(t.body=r(S,{rootName:g||h,xmlCharKey:d}))}else{if(b===D.String&&(!((c=n.contentType)===null||c===void 0)&&c.match("text/plain")||n.mediaType==="text"))return;w||(t.body=JSON.stringify(t.body))}}}catch(C){throw new Error(`Error "${C.message}" occurred in serializing the payload - ${JSON.stringify(h,void 0,"  ")}.`)}}else if(n.formDataParameters&&n.formDataParameters.length>0){t.formData={};for(const f of n.formDataParameters){const m=M(e,f);if(m!=null){const h=f.mapper.serializedName||I(f);t.formData[h]=n.serializer.serialize(f.mapper,m,I(f),u)}}}}function mo(t,e,n,r,i){if(t&&!["Composite","Sequence","Dictionary"].includes(n)){const o={};return o[i.xml.xmlCharKey]=r,o[qt]={[e]:t},o}return r}function go(t,e,n,r){if(Array.isArray(t)||(t=[t]),!n||!r)return{[e]:t};const i={[e]:t};return i[qt]={[n]:r},i}function yo(t={}){const e=ai(t??{});return t.credentialOptions&&e.addPolicy(Pi({credential:t.credentialOptions.credential,scopes:t.credentialOptions.credentialScopes})),e.addPolicy(uo(t.serializationOptions),{phase:"Serialize"}),e.addPolicy(to(t.deserializationOptions),{phase:"Deserialize"}),e}function po(t,e){return e!=="Composite"&&e!=="Dictionary"&&(typeof t=="string"||typeof t=="number"||typeof t=="boolean"||e?.match(/^(Date|DateTime|DateTimeRfc1123|UnixTime|ByteArray|Base64Url)$/i)!==null||t===void 0||t===null)}const wo=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function ja(t){return wo.test(t)}const bo=/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/i;function Ka(t){return bo.test(t)}function vo(t){const e=Object.assign(Object.assign({},t.headers),t.body);return t.hasNullableType&&Object.getOwnPropertyNames(e).length===0?t.shouldWrapBody?{body:null}:null:t.shouldWrapBody?Object.assign(Object.assign({},t.headers),{body:t.body}):e}function Kt(t,e){var n,r;const i=t.parsedHeaders;if(t.request.method==="HEAD")return Object.assign(Object.assign({},i),{body:t.parsedBody});const o=e&&e.bodyMapper,a=!!o?.nullable,s=o?.type.name;if(s==="Stream")return Object.assign(Object.assign({},i),{blobBody:t.blobBody,readableStreamBody:t.readableStreamBody});const c=s==="Composite"&&o.type.modelProperties||{},l=Object.keys(c).some(u=>c[u].serializedName==="");if(s==="Sequence"||l){const u=(n=t.parsedBody)!==null&&n!==void 0?n:[];for(const d of Object.keys(c))c[d].serializedName&&(u[d]=(r=t.parsedBody)===null||r===void 0?void 0:r[d]);if(i)for(const d of Object.keys(i))u[d]=i[d];return a&&!t.parsedBody&&!i&&Object.getOwnPropertyNames(c).length===0?null:u}return vo({body:t.parsedBody,headers:i,hasNullableType:a,shouldWrapBody:po(t.parsedBody,s)})}let We;function Ao(){return We||(We=wi()),We}const Co={CSV:",",SSV:" ",Multi:"Multi",TSV:"	",Pipes:"|"};function To(t,e,n,r){const i=So(e,n,r);let o=!1,a=Xt(t,i);if(e.path){let l=Xt(e.path,i);e.path==="/{nextLink}"&&l.startsWith("/")&&(l=l.substring(1)),Eo(l)?(a=l,o=!0):a=Ro(a,l)}const{queryParams:s,sequenceParams:c}=Po(e,n,r);return a=xo(a,s,c,o),a}function Xt(t,e){let n=t;for(const[r,i]of e)n=n.split(r).join(i);return n}function So(t,e,n){var r;const i=new Map;if(!((r=t.urlParameters)===null||r===void 0)&&r.length)for(const o of t.urlParameters){let a=M(e,o,n);const s=I(o);a=t.serializer.serialize(o.mapper,a,s),o.skipEncoding||(a=encodeURIComponent(a)),i.set(`{${o.mapper.serializedName||s}}`,a)}return i}function Eo(t){return t.includes("://")}function Ro(t,e){if(!e)return t;const n=new URL(t);let r=n.pathname;r.endsWith("/")||(r=`${r}/`),e.startsWith("/")&&(e=e.substring(1));const i=e.indexOf("?");if(i!==-1){const o=e.substring(0,i),a=e.substring(i+1);r=r+o,a&&(n.search=n.search?`${n.search}&${a}`:a)}else r=r+e;return n.pathname=r,n.toString()}function Po(t,e,n){var r;const i=new Map,o=new Set;if(!((r=t.queryParameters)===null||r===void 0)&&r.length)for(const a of t.queryParameters){a.mapper.type.name==="Sequence"&&a.mapper.serializedName&&o.add(a.mapper.serializedName);let s=M(e,a,n);if(s!=null||a.mapper.required){s=t.serializer.serialize(a.mapper,s,I(a));const c=a.collectionFormat?Co[a.collectionFormat]:"";if(Array.isArray(s)&&(s=s.map(l=>l??"")),a.collectionFormat==="Multi"&&s.length===0)continue;Array.isArray(s)&&(a.collectionFormat==="SSV"||a.collectionFormat==="TSV")&&(s=s.join(c)),a.skipEncoding||(Array.isArray(s)?s=s.map(l=>encodeURIComponent(l)):s=encodeURIComponent(s)),Array.isArray(s)&&(a.collectionFormat==="CSV"||a.collectionFormat==="Pipes")&&(s=s.join(c)),i.set(a.mapper.serializedName||I(a),s)}}return{queryParams:i,sequenceParams:o}}function _o(t){const e=new Map;if(!t||t[0]!=="?")return e;t=t.slice(1);const n=t.split("&");for(const r of n){const[i,o]=r.split("=",2),a=e.get(i);a?Array.isArray(a)?a.push(o):e.set(i,[a,o]):e.set(i,o)}return e}function xo(t,e,n,r=!1){if(e.size===0)return t;const i=new URL(t),o=_o(i.search);for(const[s,c]of e){const l=o.get(s);if(Array.isArray(l))if(Array.isArray(c)){l.push(...c);const u=new Set(l);o.set(s,Array.from(u))}else l.push(c);else l?(Array.isArray(c)?c.unshift(l):n.has(s)&&o.set(s,[l,c]),r||o.set(s,c)):o.set(s,c)}const a=[];for(const[s,c]of o)if(typeof c=="string")a.push(`${s}=${c}`);else if(Array.isArray(c))for(const l of c)a.push(`${s}=${l}`);else a.push(`${s}=${c}`);return i.search=a.length?`?${a.join("&")}`:"",i.toString()}const Io=K("core-client");class $o{constructor(e={}){var n,r;if(this._requestContentType=e.requestContentType,this._endpoint=(n=e.endpoint)!==null&&n!==void 0?n:e.baseUri,e.baseUri&&Io.warning("The baseUri option for SDK Clients has been deprecated, please use endpoint instead."),this._allowInsecureConnection=e.allowInsecureConnection,this._httpClient=e.httpClient||Ao(),this.pipeline=e.pipeline||Oo(e),!((r=e.additionalPolicies)===null||r===void 0)&&r.length)for(const{policy:i,position:o}of e.additionalPolicies){const a=o==="perRetry"?"Sign":void 0;this.pipeline.addPolicy(i,{afterPhase:a})}}async sendRequest(e){return this.pipeline.sendRequest(this._httpClient,e)}async sendOperationRequest(e,n){const r=n.baseUrl||this._endpoint;if(!r)throw new Error("If operationSpec.baseUrl is not specified, then the ServiceClient must have a endpoint string property that contains the base URL to use.");const i=To(r,n,e,this),o=ie({url:i});o.method=n.httpMethod;const a=z(o);a.operationSpec=n,a.operationArguments=e;const s=n.contentType||this._requestContentType;s&&n.requestBody&&o.headers.set("Content-Type",s);const c=e.options;if(c){const l=c.requestOptions;l&&(l.timeout&&(o.timeout=l.timeout),l.onUploadProgress&&(o.onUploadProgress=l.onUploadProgress),l.onDownloadProgress&&(o.onDownloadProgress=l.onDownloadProgress),l.shouldDeserialize!==void 0&&(a.shouldDeserialize=l.shouldDeserialize),l.allowInsecureConnection&&(o.allowInsecureConnection=!0)),c.abortSignal&&(o.abortSignal=c.abortSignal),c.tracingOptions&&(o.tracingOptions=c.tracingOptions)}this._allowInsecureConnection&&(o.allowInsecureConnection=!0),o.streamResponseStatusCodes===void 0&&(o.streamResponseStatusCodes=lo(n));try{const l=await this.sendRequest(o),u=Kt(l,n.responses[l.status]);return c?.onResponse&&c.onResponse(l,u),u}catch(l){if(typeof l=="object"&&l?.response){const u=l.response,d=Kt(u,n.responses[l.statusCode]||n.responses.default);l.details=d,c?.onResponse&&c.onResponse(u,d,l)}throw l}}}function Oo(t){const e=ko(t),n=t.credential&&e?{credentialScopes:e,credential:t.credential}:void 0;return yo(Object.assign(Object.assign({},t),{credentialOptions:n}))}function ko(t){if(t.credentialScopes)return t.credentialScopes;if(t.endpoint)return`${t.endpoint}/.default`;if(t.baseUri)return`${t.baseUri}/.default`;if(t.credential&&!t.credentialScopes)throw new Error("When using credentials, the ServiceClientOptions must contain either a endpoint or a credentialScopes. Unable to create a bearerTokenAuthenticationPolicy")}function No(t){return`, ${t.trim()}`.split(", Bearer ").filter(n=>n).map(n=>`${n.trim()}, `.split('", ').filter(o=>o).map(o=>(([a,s])=>({[a]:s}))(o.trim().split('="'))).reduce((o,a)=>Object.assign(Object.assign({},o),a),{}))}async function Xa(t){var e;const{scopes:n,response:r}=t,i=t.logger||coreClientLogger,o=r.headers.get("WWW-Authenticate");if(!o)return i.info("The WWW-Authenticate header was missing. Failed to perform the Continuous Access Evaluation authentication flow."),!1;const s=(No(o)||[]).find(l=>l.claims);if(!s)return i.info('The WWW-Authenticate header was missing the necessary "claims" to perform the Continuous Access Evaluation authentication flow.'),!1;const c=await t.getAccessToken(s.scope?[s.scope]:n,{claims:decodeStringToString(s.claims)});return c?(t.request.headers.set("Authorization",`${(e=c.tokenType)!==null&&e!==void 0?e:"Bearer"} ${c.token}`),!0):!1}const Yt={DefaultScope:"/.default",HeaderConstants:{AUTHORIZATION:"authorization"}};function Do(t){return/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/.test(t)}const Ya=async t=>{var e;const n=Bo(t.request),r=Uo(t.response);if(r){const i=Lo(r),o=zo(t,i),a=Mo(i);if(!a)return!1;const s=await t.getAccessToken(o,Object.assign(Object.assign({},n),{tenantId:a}));return s?(t.request.headers.set(Yt.HeaderConstants.AUTHORIZATION,`${(e=s.tokenType)!==null&&e!==void 0?e:"Bearer"} ${s.token}`),!0):!1}return!1};function Mo(t){const r=new URL(t.authorization_uri).pathname.split("/")[1];if(r&&Do(r))return r}function zo(t,e){if(!e.resource_id)return t.scopes;const n=new URL(e.resource_id);n.pathname=Yt.DefaultScope;let r=n.toString();return r==="https://disk.azure.com/.default"&&(r="https://disk.azure.com//.default"),[r]}function Uo(t){const e=t.headers.get("WWW-Authenticate");if(t.status===401&&e)return e}function Lo(t){return`${t.slice(7).trim()} `.split(" ").filter(i=>i).map(i=>(([o,a])=>({[o]:a}))(i.trim().split("="))).reduce((i,o)=>Object.assign(Object.assign({},i),o),{})}function Bo(t){return{abortSignal:t.abortSignal,requestOptions:{timeout:t.timeout},tracingOptions:t.tracingOptions}}function Ho(t){return t==="adfs"?"oauth2/token":"oauth2/v2.0/token"}const Jt="/.default",Ja="Specifying a `clientId` or `resourceId` is not supported by the Service Fabric managed identity environment. The managed identity configuration is determined by the Service Fabric cluster resource configuration. See https://aka.ms/servicefabricmi for more information";function Ga(t){let e="";if(Array.isArray(t)){if(t.length!==1)return;e=t[0]}else typeof t=="string"&&(e=t);return e.endsWith(Jt)?e.substr(0,e.lastIndexOf(Jt)):e}function qo(t){if(typeof t.expires_on=="number")return t.expires_on*1e3;if(typeof t.expires_on=="string"){const e=+t.expires_on;if(!isNaN(e))return e*1e3;const n=Date.parse(t.expires_on);if(!isNaN(n))return n}if(typeof t.expires_in=="number")return Date.now()+t.expires_in*1e3;throw new Error(`Failed to parse token expiration from body. expires_in="${t.expires_in}", expires_on="${t.expires_on}"`)}function Vo(t){if(t.refresh_on){if(typeof t.refresh_on=="number")return t.refresh_on*1e3;if(typeof t.refresh_on=="string"){const e=+t.refresh_on;if(!isNaN(e))return e*1e3;const n=Date.parse(t.refresh_on);if(!isNaN(n))return n}throw new Error(`Failed to parse refresh_on from body. refresh_on="${t.refresh_on}"`)}else return}var Fo=k(39907),Wo=k(1048).Buffer;const V="noCorrelationId";function jo(t){let e=t?.authorityHost;return jn&&(e=e??Fo.env.AZURE_AUTHORITY_HOST),e??xn}class Qa extends $o{constructor(e){var n,r;const i=`azsdk-js-identity/${at}`,o=!((n=e?.userAgentOptions)===null||n===void 0)&&n.userAgentPrefix?`${e.userAgentOptions.userAgentPrefix} ${i}`:`${i}`,a=jo(e);if(!a.startsWith("https:"))throw new Error("The authorityHost address must use the 'https' protocol.");super(Object.assign(Object.assign({requestContentType:"application/json; charset=utf-8",retryOptions:{maxRetries:3}},e),{userAgentOptions:{userAgentPrefix:o},baseUri:a})),this.allowInsecureConnection=!1,this.authorityHost=a,this.abortControllers=new Map,this.allowLoggingAccountIdentifiers=(r=e?.loggingOptions)===null||r===void 0?void 0:r.allowLoggingAccountIdentifiers,this.tokenCredentialOptions=Object.assign({},e),e?.allowInsecureConnection&&(this.allowInsecureConnection=e.allowInsecureConnection)}async sendTokenRequest(e){P.info(`IdentityClient: sending token request to [${e.url}]`);const n=await this.sendRequest(e);if(n.bodyAsText&&(n.status===200||n.status===201)){const r=JSON.parse(n.bodyAsText);if(!r.access_token)return null;this.logIdentifiers(n);const i={accessToken:{token:r.access_token,expiresOnTimestamp:qo(r),refreshAfterTimestamp:Vo(r),tokenType:"Bearer"},refreshToken:r.refresh_token};return P.info(`IdentityClient: [${e.url}] token acquired, expires on ${i.accessToken.expiresOnTimestamp}`),i}else{const r=new Rn(n.status,n.bodyAsText);throw P.warning(`IdentityClient: authentication error. HTTP status: ${n.status}, ${r.errorResponse.errorDescription}`),r}}async refreshAccessToken(e,n,r,i,o,a={}){if(i===void 0)return null;P.info(`IdentityClient: refreshing access token with client ID: ${n}, scopes: ${r} started`);const s={grant_type:"refresh_token",client_id:n,refresh_token:i,scope:r};o!==void 0&&(s.client_secret=o);const c=new URLSearchParams(s);return lt.withSpan("IdentityClient.refreshAccessToken",a,async l=>{try{const u=Ho(e),d=ie({url:`${this.authorityHost}/${e}/${u}`,method:"POST",body:c.toString(),abortSignal:a.abortSignal,headers:O({Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"}),tracingOptions:l.tracingOptions}),f=await this.sendTokenRequest(d);return P.info(`IdentityClient: refreshed token for client ID: ${n}`),f}catch(u){if(u.name===it&&u.errorResponse.error==="interaction_required")return P.info(`IdentityClient: interaction required for client ID: ${n}`),null;throw P.warning(`IdentityClient: failed refreshing token for client ID: ${n}: ${u}`),u}})}generateAbortSignal(e){const n=new AbortController,r=this.abortControllers.get(e)||[];r.push(n),this.abortControllers.set(e,r);const i=n.signal.onabort;return n.signal.onabort=(...o)=>{this.abortControllers.set(e,void 0),i&&i.apply(n.signal,o)},n.signal}abortRequests(e){const n=e||V,r=[...this.abortControllers.get(n)||[],...this.abortControllers.get(V)||[]];if(r.length){for(const i of r)i.abort();this.abortControllers.set(n,void 0)}}getCorrelationId(e){var n;const r=(n=e?.body)===null||n===void 0?void 0:n.split("&").map(i=>i.split("=")).find(([i])=>i==="client-request-id");return r&&r.length&&r[1]||V}async sendGetRequestAsync(e,n){const r=ie({url:e,method:"GET",body:n?.body,allowInsecureConnection:this.allowInsecureConnection,headers:O(n?.headers),abortSignal:this.generateAbortSignal(V)}),i=await this.sendRequest(r);return this.logIdentifiers(i),{body:i.bodyAsText?JSON.parse(i.bodyAsText):void 0,headers:i.headers.toJSON(),status:i.status}}async sendPostRequestAsync(e,n){const r=ie({url:e,method:"POST",body:n?.body,headers:O(n?.headers),allowInsecureConnection:this.allowInsecureConnection,abortSignal:this.generateAbortSignal(this.getCorrelationId(n))}),i=await this.sendRequest(r);return this.logIdentifiers(i),{body:i.bodyAsText?JSON.parse(i.bodyAsText):void 0,headers:i.headers.toJSON(),status:i.status}}getTokenCredentialOptions(){return this.tokenCredentialOptions}logIdentifiers(e){if(!this.allowLoggingAccountIdentifiers||!e.bodyAsText)return;const n="No User Principal Name available";try{const i=(e.parsedBody||JSON.parse(e.bodyAsText)).access_token;if(!i)return;const o=i.split(".")[1],{appid:a,upn:s,tid:c,oid:l}=JSON.parse(Wo.from(o,"base64").toString("utf8"));P.info(`[Authenticated account] Client ID: ${a}. Tenant ID: ${c}. User Principal Name: ${s||n}. Object ID (user): ${l}`)}catch(r){P.warning("allowLoggingAccountIdentifiers was set, but we couldn't log the account information. Error:",r.message)}}}const Gt=E("ClientSecretCredential");class Za{constructor(e,n,r,i){this.identityClient=new IdentityClient(i),this.tenantId=e,this.additionallyAllowedTenantIds=resolveAdditionallyAllowedTenantIds(i?.additionallyAllowedTenants),this.clientId=n,this.clientSecret=r}async getToken(e,n={}){return tracingClient.withSpan(`${this.constructor.name}.getToken`,n,async r=>{const i=processMultiTenantRequest(this.tenantId,r,this.additionallyAllowedTenantIds),o=new URLSearchParams({response_type:"token",grant_type:"client_credentials",client_id:this.clientId,client_secret:this.clientSecret,scope:typeof e=="string"?e:e.join(" ")});try{const a=getIdentityTokenEndpointSuffix(i),s=createPipelineRequest({url:`${this.identityClient.authorityHost}/${i}/${a}`,method:"POST",body:o.toString(),headers:createHttpHeaders({Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"}),abortSignal:n&&n.abortSignal,tracingOptions:r?.tracingOptions}),c=await this.identityClient.sendTokenRequest(s);return Gt.getToken.info(formatSuccess(e)),c&&c.accessToken||null}catch(a){throw Gt.getToken.info(formatError(e,a)),a}})}}const se=new Error("EnvironmentCredential is not supported in the browser."),Qt=E("EnvironmentCredential");class es{constructor(){throw Qt.info(formatError("",se)),se}getToken(){throw Qt.getToken.info(formatError("",se)),se}}const le=new Error("ClientCertificateCredential is not supported in the browser."),Zt=E("ClientCertificateCredential");class ts{constructor(){throw Zt.info(formatError("",le)),le}getToken(){throw Zt.getToken.info(formatError("",le)),le}}const ce=new Error("ClientAssertionCredential is not supported in the browser."),en=E("ClientAssertionCredential");class ns{constructor(){throw en.info(formatError("",ce)),ce}getToken(){throw en.getToken.info(formatError("",ce)),ce}}const ue=new Error("AzureCliCredential is not supported in the browser."),tn=E("AzureCliCredential");class rs{constructor(){throw tn.info(formatError("",ue)),ue}getToken(){throw tn.getToken.info(formatError("",ue)),ue}}const de=new Error("AzureDeveloperCliCredential is not supported in the browser."),nn=E("AzureDeveloperCliCredential");class is{constructor(){throw nn.info(formatError("",de)),de}getToken(){throw nn.getToken.info(formatError("",de)),de}}function os(t){return Array.isArray(t)?t:[t]}function as(t,e){if(!t.match(/^[0-9a-zA-Z-_.:/]+$/)){const n=new Error("Invalid scope was specified by the user or calling client");throw e.getToken.info(formatError(t,n)),n}}function ss(t){return t.replace(/\/.default$/,"")}const rn=typeof self<"u"&&self.location!==void 0;function Ko(t){var e;const n=t.tenantId||DefaultTenantId,r=getAuthority(n,t.authorityHost);return{auth:{clientId:t.clientId,authority:r,knownAuthorities:getKnownAuthorities(n,r,t.disableInstanceDiscovery),redirectUri:t.redirectUri||(rn?self.location.origin:void 0)},cache:{cacheLocation:"sessionStorage",storeAuthStateInCookie:!0},system:{loggerOptions:{loggerCallback:defaultLoggerCallback(t.logger,"Browser"),logLevel:getMSALLogLevel(getLogLevel()),piiLoggingEnabled:(e=t.loggingOptions)===null||e===void 0?void 0:e.enableUnsafeSupportLogging}}}}const Xo=rn?self.location.hash:void 0;function ls(t){var e;const n=t.loginStyle;if(!t.clientId)throw new CredentialUnavailableError("A client ID is required in browsers");const r=t.clientId,i=t.logger,o=resolveTenantId(i,t.tenantId,t.clientId),a=resolveAdditionallyAllowedTenantIds((e=t?.tokenCredentialOptions)===null||e===void 0?void 0:e.additionallyAllowedTenants),s=t.authorityHost,c=Ko(t),l=t.disableAutomaticAuthentication,u=t.loginHint;let d;t.authenticationRecord&&(d=Object.assign(Object.assign({},t.authenticationRecord),{tenantId:o}));let f;async function m(){return f||(f=await msalBrowser.PublicClientApplication.createPublicClientApplication(c),d&&f.setActiveAccount(publicToMsal(d))),f}async function h(w){try{const y=await m();if(w&&w.account)return i.info("MSAL Browser V2 authentication successful."),y.setActiveAccount(w.account),msalToPublic(r,w.account);const S=y.getActiveAccount();if(S)return msalToPublic(r,S);const T=f.getAllAccounts();if(T.length>1){i.info(`More than one account was found authenticated for this Client ID and Tenant ID.
  However, no "authenticationRecord" has been provided for this credential,
  therefore we're unable to pick between these accounts.
  A new login attempt will be requested, to ensure the correct account is picked.
  To work with multiple accounts for the same Client ID and Tenant ID, please provide an "authenticationRecord" when initializing "InteractiveBrowserCredential".`),await y.logout({onRedirectNavigate:()=>!1});return}if(T.length===1){const x=T[0];return y.setActiveAccount(x),msalToPublic(r,x)}i.info("No accounts were found through MSAL.")}catch(y){i.info(`Failed to acquire token through MSAL. ${y.message}`)}}function g(w,y,S){var T;return y?.account&&(d=msalToPublic(r,y.account)),ensureValidMsalToken(w,y,S),i.getToken.info(formatSuccess(w)),{token:y.accessToken,expiresOnTimestamp:y.expiresOn.getTime(),refreshAfterTimestamp:(T=y.refreshOn)===null||T===void 0?void 0:T.getTime(),tokenType:"Bearer"}}async function p(){const w=await m();return h(await w.handleRedirectPromise(Xo)||void 0)}async function v(){const y=(await m()).getActiveAccount();if(y)return msalToPublic(r,y)}async function A(w=[]){const S={scopes:Array.isArray(w)?w:[w],loginHint:u},T=await m();switch(n){case"redirect":{await f.loginRedirect(S);return}case"popup":return h(await T.loginPopup(S))}}async function R(w,y){const S=await v();if(!S)throw new AuthenticationRequiredError({scopes:w,getTokenOptions:y,message:"Silent authentication failed. We couldn't retrieve an active account from the cache."});const T={authority:y?.authority||c.auth.authority,correlationId:y?.correlationId,claims:y?.claims,account:publicToMsal(S),forceRefresh:!1,scopes:w};try{i.info("Attempting to acquire token silently");const Ke=await(await m()).acquireTokenSilent(T);return g(w,Ke)}catch(x){throw handleMsalError(w,x,t)}}async function b(w,y){const S=await v();if(!S)throw new AuthenticationRequiredError({scopes:w,getTokenOptions:y,message:"Silent authentication failed. We couldn't retrieve an active account from the cache."});const T={authority:y?.authority||c.auth.authority,correlationId:y?.correlationId,claims:y?.claims,account:publicToMsal(S),loginHint:u,scopes:w},x=await m();switch(n){case"redirect":return await x.acquireTokenRedirect(T),{token:"",expiresOnTimestamp:0,tokenType:"Bearer"};case"popup":return g(w,await f.acquireTokenPopup(T))}}async function C(w,y={}){const S=processMultiTenantRequest(o,y,a)||o;y.authority||(y.authority=getAuthority(S,s)),await p(),!await v()&&!l&&await A(w);try{return await R(w,y)}catch(T){if(T.name!=="AuthenticationRequiredError")throw T;if(y?.disableAutomaticAuthentication)throw new AuthenticationRequiredError({scopes:w,getTokenOptions:y,message:"Automatic authentication has been disabled. You may call the authenticate() method."});return i.info(`Silent authentication failed, falling back to interactive method ${n}`),b(w,y)}}return{getActiveAccount:v,getToken:C}}const je=E("InteractiveBrowserCredential");class cs{constructor(e){if(!e?.clientId){const a=new Error("The parameter `clientId` cannot be left undefined for the `InteractiveBrowserCredential`");throw je.info(formatError("",a)),a}this.tenantId=e?.tenantId,this.additionallyAllowedTenantIds=resolveAdditionallyAllowedTenantIds(e?.additionallyAllowedTenants);const n=e,r=n.loginStyle||"popup",i=["redirect","popup"];if(i.indexOf(r)===-1){const a=new Error(`Invalid loginStyle: ${n.loginStyle}. Should be any of the following: ${i.join(", ")}.`);throw je.info(formatError("",a)),a}const o=Object.assign(Object.assign({},e),{tokenCredentialOptions:e,logger:je,loginStyle:r,redirectUri:typeof e.redirectUri=="function"?e.redirectUri():e.redirectUri});this.msalClient=createMsalBrowserClient(o),this.disableAutomaticAuthentication=e?.disableAutomaticAuthentication}async getToken(e,n={}){return tracingClient.withSpan(`${this.constructor.name}.getToken`,n,async r=>{const i=processMultiTenantRequest(this.tenantId,r,this.additionallyAllowedTenantIds);r.tenantId=i;const o=ensureScopes(e);return this.msalClient.getToken(o,Object.assign(Object.assign({},r),{disableAutomaticAuthentication:this.disableAutomaticAuthentication}))})}async authenticate(e,n={}){return tracingClient.withSpan(`${this.constructor.name}.authenticate`,n,async r=>{const i=Array.isArray(e)?e:[e];return await this.msalClient.getToken(i,r),this.msalClient.getActiveAccount()})}}const fe=new Error("ManagedIdentityCredential is not supported in the browser."),on=E("ManagedIdentityCredential");class us{constructor(){throw on.info(formatError("",fe)),fe}async getToken(){throw on.getToken.info(formatError("",fe)),fe}}const he=new Error("DeviceCodeCredential is not supported in the browser."),an=E("DeviceCodeCredential");class ds{constructor(){throw an.info(formatError("",he)),he}getToken(){throw an.getToken.info(formatError("",he)),he}}const me=new Error("AzurePipelinesCredential is not supported in the browser."),sn=E("AzurePipelinesCredential");class fs{constructor(){throw sn.info(formatError("",me)),me}getToken(){throw sn.getToken.info(formatError("",me)),me}}const ge=new Error("AuthorizationCodeCredential is not supported in the browser. InteractiveBrowserCredential is more appropriate for this use case."),ln=E("AuthorizationCodeCredential");class hs{constructor(){throw ln.info(formatError("",ge)),ge}getToken(){throw ln.getToken.info(formatError("",ge)),ge}}const ye=new Error("AzurePowerShellCredential is not supported in the browser."),cn=E("AzurePowerShellCredential");class ms{constructor(){throw cn.info(formatError("",ye)),ye}getToken(){throw cn.getToken.info(formatError("",ye)),ye}}const un=E("UsernamePasswordCredential");class gs{constructor(e,n,r,i,o){checkTenantId(un,e),this.identityClient=new IdentityClient(o),this.tenantId=e,this.additionallyAllowedTenantIds=resolveAdditionallyAllowedTenantIds(o?.additionallyAllowedTenants),this.clientId=n,this.username=r,this.password=i}async getToken(e,n={}){return tracingClient.withSpan("UsernamePasswordCredential.getToken",n,async r=>{const i=processMultiTenantRequest(this.tenantId,r,this.additionallyAllowedTenantIds);r.tenantId=i;const o=getIdentityTokenEndpointSuffix(this.tenantId),a=new URLSearchParams({response_type:"token",grant_type:"password",client_id:this.clientId,username:this.username,password:this.password,scope:typeof e=="string"?e:e.join(" ")}),s=createPipelineRequest({url:`${this.identityClient.authorityHost}/${this.tenantId}/${o}`,method:"POST",body:a.toString(),headers:createHttpHeaders({Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"}),abortSignal:n&&n.abortSignal,tracingOptions:r.tracingOptions}),c=await this.identityClient.sendTokenRequest(s);return un.getToken.info(formatSuccess(e)),c&&c.accessToken||null})}}const pe=new Error("VisualStudioCodeCredential is not supported in the browser."),dn=E("VisualStudioCodeCredential"),ys={set vsCodeCredentialFinder(t){throw new Error("Attempted to register a VisualStudioCodeCredential provider plugin in the browser. This environment is not supported by VisualStudioCodeCredential.")}};class ps{constructor(){throw dn.info(formatError("",pe)),pe}getToken(){throw dn.getToken.info(formatError("",pe)),pe}}const fn="OnBehalfOfCredential",we=new Error(`${fn}: Not supported in the browser.`),hn=E(fn);class ws{constructor(){throw hn.info(formatError("",we)),we}getToken(){throw hn.getToken.info(formatError("",we)),we}}const be=new Error("WorkloadIdentityCredential is not supported in the browser."),mn=E("WorkloadIdentityCredential");class bs{constructor(){throw mn.info(formatError("",be)),be}getToken(){throw mn.getToken.info(formatError("",be)),be}}function vs(t,e,n){const{abortSignal:r,tracingOptions:i}=n||{},o=createEmptyPipeline();o.addPolicy(bearerTokenAuthenticationPolicy({credential:t,scopes:e}));async function a(){var s;const l=(s=(await o.sendRequest({sendRequest:u=>Promise.resolve({request:u,status:200,headers:u.headers})},createPipelineRequest({url:"https://example.com",abortSignal:r,tracingOptions:i}))).headers.get("authorization"))===null||s===void 0?void 0:s.split(" ")[1];if(!l)throw new Error("Failed to get access token");return l}return a}function As(){return new DefaultAzureCredential}}}]);})();

//# sourceMappingURL=module-azure.51a66d54.js.map